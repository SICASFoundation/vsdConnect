

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>connect &mdash; VSDConnect 0.8.1 documentation</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  

  

  
    <link rel="top" title="VSDConnect 0.8.1 documentation" href="../index.html"/>
        <link rel="up" title="Module code" href="index.html"/> 

  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../index.html" class="icon icon-home"> VSDConnect
          

          
          </a>

          
            
            
              <div class="version">
                0.8.1
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <ul>
<li class="toctree-l1"><a class="reference internal" href="../connect.html">vsdConnect.connect module</a></li>
<li class="toctree-l1"><a class="reference internal" href="../models.html">vsdConnect.models module</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../index.html">VSDConnect</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          





<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../index.html">Docs</a> &raquo;</li>
      
          <li><a href="index.html">Module code</a> &raquo;</li>
      
    <li>connect</li>
      <li class="wy-breadcrumbs-aside">
        
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <h1>Source code for connect</h1><div class="highlight"><pre>
<span></span><span class="ch">#!/usr/bin/python</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">=======</span>
<span class="sd">INFOS</span>
<span class="sd">=======</span>

<span class="sd">- connect 0.8.1</span>
<span class="sd">- python version: 3.5</span>
<span class="sd">- @author: Michael Kistler 2015, Livia B 2016</span>

<span class="sd">========</span>
<span class="sd">CHANGES</span>
<span class="sd">========</span>

<span class="sd">* changed / added JwT auth</span>
<span class="sd">* added models module </span>


<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">from</span> <span class="nn">__future__</span> <span class="k">import</span> <span class="n">print_function</span>

<span class="kn">import</span> <span class="nn">math</span>
<span class="kn">import</span> <span class="nn">hashlib</span>

<span class="kn">from</span> <span class="nn">datetime</span> <span class="k">import</span> <span class="n">datetime</span>
<span class="kn">from</span> <span class="nn">calendar</span> <span class="k">import</span> <span class="n">timegm</span>
<span class="kn">import</span> <span class="nn">base64</span>

<span class="kn">import</span> <span class="nn">urllib</span>
<span class="kn">import</span> <span class="nn">jwt</span>

<span class="k">try</span><span class="p">:</span> 
    <span class="kn">from</span> <span class="nn">urllib.parse</span> <span class="k">import</span> <span class="n">urlparse</span>
    <span class="kn">from</span> <span class="nn">urllib.parse</span> <span class="k">import</span> <span class="n">quote</span> <span class="k">as</span> <span class="n">urlparse_quote</span>
<span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>
    <span class="kn">from</span> <span class="nn">urlparse</span> <span class="k">import</span> <span class="n">urlparse</span>
    <span class="kn">from</span> <span class="nn">urllib</span> <span class="k">import</span> <span class="n">quote</span> <span class="k">as</span> <span class="n">urlparse_quote</span>

<span class="kn">import</span> <span class="nn">json</span>

<span class="kn">from</span> <span class="nn">pathlib</span> <span class="k">import</span> <span class="n">Path</span><span class="p">,</span> <span class="n">PurePath</span><span class="p">,</span> <span class="n">WindowsPath</span>
<span class="kn">import</span> <span class="nn">requests</span>
<span class="kn">from</span> <span class="nn">requests.auth</span> <span class="k">import</span> <span class="n">AuthBase</span>

<span class="kn">import</span> <span class="nn">io</span>
<span class="kn">import</span> <span class="nn">base64</span>
<span class="kn">import</span> <span class="nn">zlib</span>

<span class="k">try</span><span class="p">:</span>
    <span class="kn">import</span> <span class="nn">lxml.etree</span> <span class="k">as</span> <span class="nn">ET</span>
<span class="k">except</span><span class="p">:</span>
    <span class="kn">import</span> <span class="nn">xml.etree.ElementTree</span> <span class="k">as</span> <span class="nn">ET</span>

<span class="kn">import</span> <span class="nn">models</span> <span class="k">as</span> <span class="nn">vsdModels</span>
<span class="kn">import</span> <span class="nn">logging</span>

<span class="n">logger</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="n">__name__</span><span class="p">)</span>

<span class="n">requests</span><span class="o">.</span><span class="n">packages</span><span class="o">.</span><span class="n">urllib3</span><span class="o">.</span><span class="n">disable_warnings</span><span class="p">()</span>


<div class="viewcode-block" id="SAMLAuth"><a class="viewcode-back" href="../connect.html#connect.SAMLAuth">[docs]</a><span class="k">class</span> <span class="nc">SAMLAuth</span><span class="p">(</span><span class="n">AuthBase</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Attaches SMAL to the given Request object. extends the request package auth class&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">enctoken</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">enctoken</span> <span class="o">=</span> <span class="n">enctoken</span>

    <span class="k">def</span> <span class="nf">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">r</span><span class="p">):</span>
        <span class="c1"># modify and return the request</span>
        <span class="n">r</span><span class="o">.</span><span class="n">headers</span><span class="p">[</span><span class="s1">&#39;Authorization&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">b</span><span class="s1">&#39;SAML auth=&#39;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">enctoken</span>
        <span class="k">return</span> <span class="n">r</span></div>


<div class="viewcode-block" id="samltoken"><a class="viewcode-back" href="../connect.html#connect.samltoken">[docs]</a><span class="k">def</span> <span class="nf">samltoken</span><span class="p">(</span><span class="n">fp</span><span class="p">,</span> <span class="n">stsurl</span><span class="o">=</span><span class="s1">&#39;https://ciam-dev-chic.custodix.com/sts/services/STS&#39;</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    generates the saml auth token from a credentials file</span>

<span class="sd">    :param Path fp: file with the credentials (xml file)</span>
<span class="sd">    :param str stsurl: url to the STS authority</span>
<span class="sd">    :return: enctoken - the encoded token</span>
<span class="sd">    :rtype: byte</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="n">fp</span><span class="o">.</span><span class="n">is_file</span><span class="p">():</span>
        <span class="n">tree</span> <span class="o">=</span> <span class="n">ET</span><span class="o">.</span><span class="n">ElementTree</span><span class="p">()</span>
        <span class="n">dom</span> <span class="o">=</span> <span class="n">tree</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">fp</span><span class="p">))</span>
        <span class="n">authdata</span> <span class="o">=</span> <span class="n">ET</span><span class="o">.</span><span class="n">tostring</span><span class="p">(</span><span class="n">dom</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s1">&#39;utf-8&#39;</span><span class="p">)</span>

    <span class="c1"># send the xml in the attachment to https://ciam-dev-chic.custodix.com/sts/services/STS</span>
    <span class="n">r</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">stsurl</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">authdata</span><span class="p">,</span> <span class="n">verify</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">r</span><span class="o">.</span><span class="n">status_code</span> <span class="o">==</span> <span class="mi">200</span><span class="p">:</span>

        <span class="n">fileobject</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">BytesIO</span><span class="p">(</span><span class="n">r</span><span class="o">.</span><span class="n">content</span><span class="p">)</span>

        <span class="n">tree</span> <span class="o">=</span> <span class="n">ET</span><span class="o">.</span><span class="n">ElementTree</span><span class="p">()</span>
        <span class="n">dom</span> <span class="o">=</span> <span class="n">tree</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="n">fileobject</span><span class="p">)</span>
        <span class="n">saml</span> <span class="o">=</span> <span class="n">ET</span><span class="o">.</span><span class="n">tostring</span><span class="p">(</span><span class="n">dom</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s2">&quot;xml&quot;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s2">&quot;utf-8&quot;</span><span class="p">)</span>

        <span class="c1"># ZLIB (RFC 1950) compress the retrieved SAML token.</span>
        <span class="n">ztoken</span> <span class="o">=</span> <span class="n">zlib</span><span class="o">.</span><span class="n">compress</span><span class="p">(</span><span class="n">saml</span><span class="p">,</span> <span class="mi">9</span><span class="p">)</span>

        <span class="c1"># Base64 (RFC 4648) encode the compressed SAML token.</span>
        <span class="n">enctoken</span> <span class="o">=</span> <span class="n">base64</span><span class="o">.</span><span class="n">b64encode</span><span class="p">(</span><span class="n">ztoken</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">enctoken</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">None</span></div>


<div class="viewcode-block" id="JWTAuth"><a class="viewcode-back" href="../connect.html#connect.JWTAuth">[docs]</a><span class="k">class</span> <span class="nc">JWTAuth</span><span class="p">(</span><span class="n">AuthBase</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Attaches JMT to the given Request object. extends the request package auth class&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">enctoken</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">enctoken</span> <span class="o">=</span> <span class="n">enctoken</span>

    <span class="k">def</span> <span class="nf">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">r</span><span class="p">):</span>
        <span class="c1"># modify and return the request</span>
        <span class="n">r</span><span class="o">.</span><span class="n">headers</span><span class="p">[</span><span class="s1">&#39;Authorization&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;Bearer &#39;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">enctoken</span>
        <span class="k">return</span> <span class="n">r</span></div>


<div class="viewcode-block" id="VSDConnecter"><a class="viewcode-back" href="../connect.html#connect.VSDConnecter">[docs]</a><span class="k">class</span> <span class="nc">VSDConnecter</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span>
            <span class="n">authtype</span><span class="o">=</span><span class="s1">&#39;jwt&#39;</span><span class="p">,</span>
            <span class="n">url</span><span class="o">=</span><span class="s2">&quot;https://demo.virtualskeleton.ch/api/&quot;</span><span class="p">,</span>
            <span class="n">username</span><span class="o">=</span><span class="s2">&quot;demo@virtualskeleton.ch&quot;</span><span class="p">,</span>
            <span class="n">password</span><span class="o">=</span><span class="s2">&quot;demo&quot;</span><span class="p">,</span>
            <span class="n">version</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span>
            <span class="n">token</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="p">):</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">version</span> <span class="o">=</span> <span class="n">version</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">url</span> <span class="o">=</span> <span class="n">url</span> <span class="o">+</span> <span class="n">version</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">s</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">Session</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">s</span><span class="o">.</span><span class="n">verify</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">authtype</span> <span class="o">=</span> <span class="n">authtype</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">maxAttempts</span> <span class="o">=</span> <span class="mi">3</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">maxAttempts401</span> <span class="o">=</span> <span class="mi">2</span>

        <span class="k">if</span> <span class="n">version</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">version</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">version</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;/&#39;</span>

        <span class="k">if</span> <span class="n">authtype</span> <span class="o">==</span> <span class="s1">&#39;basic&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">username</span> <span class="o">=</span> <span class="n">username</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">password</span> <span class="o">=</span> <span class="n">password</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">s</span><span class="o">.</span><span class="n">auth</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">username</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">password</span><span class="p">)</span>

        <span class="k">elif</span> <span class="n">authtype</span> <span class="o">==</span> <span class="s1">&#39;saml&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">token</span> <span class="o">=</span> <span class="n">token</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">s</span><span class="o">.</span><span class="n">auth</span> <span class="o">=</span> <span class="n">SAMLAuth</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">token</span><span class="p">)</span>

        <span class="k">elif</span> <span class="n">authtype</span> <span class="o">==</span> <span class="s1">&#39;jwt&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">username</span> <span class="o">=</span> <span class="n">username</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">password</span> <span class="o">=</span> <span class="n">password</span>
            <span class="n">token</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getJWTtoken</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">token</span> <span class="o">=</span> <span class="n">token</span><span class="o">.</span><span class="n">tokenValue</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">s</span><span class="o">.</span><span class="n">auth</span> <span class="o">=</span> <span class="n">JWTAuth</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">token</span><span class="p">)</span>


<span class="c1">####################</span>
<span class="c1">#session management</span>
<span class="c1">####################   </span>


    <span class="k">def</span> <span class="nf">_validate_exp</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        checks if the session is still valid</span>
<span class="sd">        :return: if validation is expired or not</span>
<span class="sd">        :rtype: bool</span>
<span class="sd">        :raises:  DecodeError</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">now</span> <span class="o">=</span> <span class="n">timegm</span><span class="p">(</span><span class="n">datetime</span><span class="o">.</span><span class="n">utcnow</span><span class="p">()</span><span class="o">.</span><span class="n">utctimetuple</span><span class="p">())</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">authtype</span> <span class="o">==</span> <span class="s1">&#39;jwt&#39;</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;token&#39;</span><span class="p">):</span>
                <span class="c1"># I pass here only one time, when I request a token</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">token</span> <span class="o">=</span> <span class="kc">None</span>
                <span class="k">return</span> <span class="kc">True</span>
            <span class="n">payload</span> <span class="o">=</span> <span class="n">jwt</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">token</span><span class="p">,</span> <span class="n">verify</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">exp</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">payload</span><span class="p">[</span><span class="s1">&#39;exp&#39;</span><span class="p">])</span>
            <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">jwt</span><span class="o">.</span><span class="n">DecodeError</span><span class="p">(</span><span class="s1">&#39;Expiration Time claim (exp) must be an&#39;</span>
                                      <span class="s1">&#39; integer.&#39;</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">exp</span> <span class="o">&lt;</span> <span class="n">now</span><span class="p">:</span>
                <span class="c1"># raise jwt.ExpiredSignatureError(&#39;Signature has expired&#39;)</span>
                <span class="k">return</span> <span class="kc">False</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">s</span><span class="o">.</span><span class="n">auth</span> <span class="o">=</span> <span class="n">JWTAuth</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">token</span><span class="p">)</span>
                <span class="k">return</span> <span class="kc">True</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">True</span>

    <span class="k">def</span> <span class="nf">_stayAlive</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        checks if the token has expired, if yes, request a new token and initiates a new session</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_validate_exp</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">s</span><span class="o">.</span><span class="n">auth</span> <span class="o">=</span> <span class="n">JWTAuth</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">getJWTtoken</span><span class="p">()</span><span class="o">.</span><span class="n">tokenValue</span><span class="p">)</span>

<div class="viewcode-block" id="VSDConnecter.getJWTtoken"><a class="viewcode-back" href="../connect.html#connect.VSDConnecter.getJWTtoken">[docs]</a>    <span class="k">def</span> <span class="nf">getJWTtoken</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        request the JWT token from the server using Basic Auth</span>

<span class="sd">        :return: token - a authentication token or None</span>
<span class="sd">        :rtype: Token or None</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">token</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">res</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">s</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">url</span> <span class="o">+</span> <span class="s1">&#39;tokens/jwt&#39;</span><span class="p">,</span> <span class="n">auth</span><span class="o">=</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">username</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">password</span><span class="p">),</span> <span class="n">verify</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
            <span class="n">res</span><span class="o">.</span><span class="n">raise_for_status</span><span class="p">()</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="n">res</span><span class="p">)</span>
            <span class="k">raise</span>
        <span class="n">token</span> <span class="o">=</span> <span class="n">vsdModels</span><span class="o">.</span><span class="n">Token</span><span class="p">(</span><span class="o">**</span><span class="n">res</span><span class="o">.</span><span class="n">json</span><span class="p">())</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">payload</span> <span class="o">=</span> <span class="n">jwt</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="n">token</span><span class="o">.</span><span class="n">tokenValue</span><span class="p">,</span> <span class="n">verify</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

        <span class="k">except</span> <span class="n">jwt</span><span class="o">.</span><span class="n">InvalidTokenError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s1">&#39;token invalid, try using Basic Auth</span><span class="si">{0}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>
            <span class="k">raise</span>

        <span class="k">return</span> <span class="n">token</span></div>

    <span class="c1">#################################################</span>
    <span class="c1"># requests library wrappers</span>
    <span class="c1">################################################</span>

    <span class="k">def</span> <span class="nf">_download</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">url</span><span class="p">,</span> <span class="n">fp</span><span class="p">,</span> <span class="n">onlyHeader</span> <span class="o">=</span> <span class="kc">False</span><span class="p">):</span>
        <span class="n">r</span> <span class="o">=</span> <span class="n">urlparse</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
        <span class="n">res</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_requestsAttempts</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">s</span><span class="o">.</span><span class="n">get</span><span class="p">,</span> <span class="n">r</span><span class="o">.</span><span class="n">geturl</span><span class="p">(),</span> <span class="n">params</span><span class="o">=</span><span class="n">r</span><span class="o">.</span><span class="n">params</span><span class="p">,</span> <span class="n">stream</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">filename</span> <span class="o">=</span> <span class="n">fp</span><span class="o">.</span><span class="n">name</span>  <span class="c1"># path object</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="n">filename</span> <span class="o">=</span> <span class="n">fp</span>  <span class="c1"># string</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="s1">&#39;wb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">n</span><span class="p">,</span> <span class="n">chunk</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">iter_content</span><span class="p">(</span><span class="mi">1024</span><span class="p">)):</span>
                <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">chunk</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">onlyHeader</span> <span class="ow">and</span> <span class="n">n</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">:</span>
                    <span class="k">break</span>
        <span class="k">return</span> <span class="n">filename</span>


    <span class="k">def</span> <span class="nf">_requestsAttempts</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">method</span><span class="p">,</span> <span class="n">url</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="c1">#     generic wrapper around request library with multiple attempts</span>
        <span class="c1">#     replaces self._httpResponseCheck(self, response):</span>
        <span class="c1">#     :param method: string of the method to call &quot;get&quot;, &quot;put&quot;</span>
        <span class="c1">#     :param url: full  url</span>
        <span class="c1">#     :param args: args for request call</span>
        <span class="c1">#     :param kwargs: kwargs for request call</span>
        <span class="c1">#     :return: request object (raise if error after self.maxAttempts)</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">maxAttempts</span><span class="p">):</span>
            <span class="n">res</span> <span class="o">=</span> <span class="n">method</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_stayAlive</span><span class="p">()</span>
                <span class="n">res</span><span class="o">.</span><span class="n">raise_for_status</span><span class="p">()</span>
                <span class="k">return</span> <span class="n">res</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Connection attempt </span><span class="si">%s</span><span class="s2">/</span><span class="si">%s</span><span class="s2">: </span><span class="si">%s</span><span class="s2"> </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">maxAttempts</span><span class="p">,</span> <span class="n">res</span> <span class="p">,</span> <span class="n">url</span><span class="p">))</span>
                <span class="k">if</span> <span class="n">res</span><span class="o">.</span><span class="n">status_code</span> <span class="o">==</span> <span class="mi">401</span> <span class="ow">and</span> <span class="n">i</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">maxAttempts401</span><span class="p">:</span>
                    <span class="k">raise</span>
        <span class="c1"># re-raise if &gt; max attempts</span>
        <span class="n">res</span><span class="o">.</span><span class="n">raise_for_status</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">_get</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">resource</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>  <span class="c1"># reimplements VSDConnect.getRequest</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_requestsAttempts</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">s</span><span class="o">.</span><span class="n">get</span><span class="p">,</span> <span class="n">resource</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span><span class="o">.</span><span class="n">json</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">_put</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">resource</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>  <span class="c1"># reimplements VSDConnect.putRequest</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_requestsAttempts</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">s</span><span class="o">.</span><span class="n">put</span><span class="p">,</span> <span class="n">resource</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span><span class="o">.</span><span class="n">json</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">_delete</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">resource</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>  <span class="c1"># reimplements VSDConnect.postRequest</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_requestsAttempts</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">s</span><span class="o">.</span><span class="n">delete</span><span class="p">,</span> <span class="n">resource</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span><span class="o">.</span><span class="n">json</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">_post</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">resource</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="c1"># should I avoid multiplt attempts? not idempotent, no multiple  attempts</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_requestsAttempts</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">s</span><span class="o">.</span><span class="n">post</span><span class="p">,</span> <span class="n">resource</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span><span class="o">.</span><span class="n">json</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">_options</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">resource</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>  <span class="c1"># reimplements VSDConnect.getRequest</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_requestsAttempts</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">s</span><span class="o">.</span><span class="n">options</span><span class="p">,</span> <span class="n">resource</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span><span class="o">.</span><span class="n">json</span><span class="p">()</span>

    <span class="c1">#################################################</span>
    <span class="c1"># api objects handling</span>
    <span class="c1">################################################</span>


<div class="viewcode-block" id="VSDConnecter.getObjectType"><a class="viewcode-back" href="../connect.html#connect.VSDConnecter.getObjectType">[docs]</a>    <span class="k">def</span> <span class="nf">getObjectType</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">response</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        create an APIObject depending on the type</span>

<span class="sd">        :param json response: object data</span>
<span class="sd">        :return: object</span>
<span class="sd">        :rtype: APIObject</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">apiObject</span> <span class="o">=</span> <span class="n">vsdModels</span><span class="o">.</span><span class="n">APIObject</span><span class="p">(</span><span class="o">**</span><span class="n">response</span><span class="p">)</span>
        <span class="n">objectType</span> <span class="o">=</span> <span class="n">apiObject</span><span class="o">.</span><span class="n">type</span><span class="o">.</span><span class="n">name</span>  <span class="c1"># &#39;RawImage&#39;</span>
        <span class="k">if</span> <span class="n">objectType</span> <span class="ow">not</span> <span class="ow">in</span> <span class="nb">dir</span><span class="p">(</span><span class="n">vsdModels</span><span class="p">):</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;Unknown type </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">objectType</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">vsdModels</span><span class="o">.</span><span class="n">APIObject</span>
        <span class="n">obj</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">vsdModels</span><span class="p">,</span> <span class="n">objectType</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">obj</span></div>

<div class="viewcode-block" id="VSDConnecter.createObject"><a class="viewcode-back" href="../connect.html#connect.VSDConnecter.createObject">[docs]</a>    <span class="k">def</span> <span class="nf">createObject</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">response</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        please describe the purpose here</span>

<span class="sd">        convert  fields to response dict</span>
<span class="sd">        how to use it?, cant we use: json.dumps(self.to_struct()) </span>
<span class="sd">        </span>
<span class="sd">        :param bool response: ???</span>
<span class="sd">        :param **kwargs: ???</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">response</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">response</span> <span class="o">=</span> <span class="n">kwargs</span>
        <span class="n">objType</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getObjectType</span><span class="p">(</span><span class="n">response</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">objType</span><span class="p">(</span><span class="o">**</span><span class="n">response</span><span class="p">)</span></div>

<div class="viewcode-block" id="VSDConnecter.parseUrl"><a class="viewcode-back" href="../connect.html#connect.VSDConnecter.parseUrl">[docs]</a>    <span class="k">def</span> <span class="nf">parseUrl</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">resource</span><span class="p">,</span> <span class="nb">type</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        check if the resource is  int (ID) or the selfURL</span>

<span class="sd">        :param str resource: url to the resource</span>
<span class="sd">        :param str type: type of the api resource (folders, objects etc)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">rId</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">resource</span><span class="p">)</span>
            <span class="n">resource</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">/</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="nb">type</span><span class="p">,</span> <span class="n">rId</span><span class="p">)</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="k">pass</span>
        <span class="k">assert</span> <span class="nb">type</span> <span class="ow">in</span> <span class="n">resource</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">fullUrl</span><span class="p">(</span><span class="n">resource</span><span class="p">)</span></div>

<div class="viewcode-block" id="VSDConnecter.fullUrl"><a class="viewcode-back" href="../connect.html#connect.VSDConnecter.fullUrl">[docs]</a>    <span class="k">def</span> <span class="nf">fullUrl</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">resource</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        check if resource is selfUrl or relative path. a correct full path will be returned</span>

<span class="sd">        :param str resource: the api resource path</span>
<span class="sd">        :return: the full resource path</span>
<span class="sd">        :rtype: str</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">res</span> <span class="o">=</span> <span class="n">urlparse</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">resource</span><span class="p">))</span>

        <span class="k">if</span> <span class="n">res</span><span class="o">.</span><span class="n">scheme</span> <span class="o">==</span> <span class="s1">&#39;https&#39;</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">resource</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">url</span> <span class="o">+</span> <span class="n">resource</span></div>

<div class="viewcode-block" id="VSDConnecter.optionsRequest"><a class="viewcode-back" href="../connect.html#connect.VSDConnecter.optionsRequest">[docs]</a>    <span class="k">def</span> <span class="nf">optionsRequest</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">resource</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        generic options request function</span>

<span class="sd">        :param str resource: the api resource path</span>
<span class="sd">        :return: json data result or None</span>
<span class="sd">        :rtype: json or None</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_stayAlive</span><span class="p">()</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_options</span><span class="p">(</span><span class="n">resource</span><span class="p">)</span></div>

    <span class="c1">#################################################</span>
    <span class="c1"># api objects handling (READ)</span>
    <span class="c1">################################################</span>

<div class="viewcode-block" id="VSDConnecter.getRequest"><a class="viewcode-back" href="../connect.html#connect.VSDConnecter.getRequest">[docs]</a>    <span class="k">def</span> <span class="nf">getRequest</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">resource</span><span class="p">,</span> <span class="n">rpp</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">page</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">include</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        generic get request function</span>

<span class="sd">        :param str resource: resource path</span>
<span class="sd">        :param int rpp: results per page to show</span>
<span class="sd">        :param int page: page nr to show, starts with 0</span>
<span class="sd">        :param str include: option to include more informations</span>
<span class="sd">        :return: list of objects or None</span>
<span class="sd">        :rtype: json or None</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">params</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">([(</span><span class="s1">&#39;rpp&#39;</span><span class="p">,</span> <span class="n">rpp</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;page&#39;</span><span class="p">,</span> <span class="n">page</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;include&#39;</span><span class="p">,</span> <span class="n">include</span><span class="p">)])</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fullUrl</span><span class="p">(</span><span class="n">resource</span><span class="p">),</span> <span class="n">params</span><span class="o">=</span><span class="n">params</span><span class="p">)</span></div>


<div class="viewcode-block" id="VSDConnecter.downloadZip"><a class="viewcode-back" href="../connect.html#connect.VSDConnecter.downloadZip">[docs]</a>    <span class="k">def</span> <span class="nf">downloadZip</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">resource</span><span class="p">,</span> <span class="n">fp</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        download the zipfile into the given file (fp)</span>

<span class="sd">        :param str resource: download URL</span>
<span class="sd">        :param Path fp:  filepath</span>
<span class="sd">        :return: None or status_code ok (200)</span>
<span class="sd">        :rtype: int</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_stayAlive</span><span class="p">()</span>

        <span class="n">res</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">s</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fullUrl</span><span class="p">(</span><span class="n">resource</span><span class="p">),</span> <span class="n">stream</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">res</span><span class="o">.</span><span class="n">ok</span><span class="p">:</span>
            <span class="k">with</span> <span class="n">fp</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s1">&#39;wb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
                <span class="n">shutil</span><span class="o">.</span><span class="n">copyfileobj</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">raw</span><span class="p">,</span> <span class="n">f</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">res</span><span class="o">.</span><span class="n">status_code</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span></div>


<div class="viewcode-block" id="VSDConnecter.downloadObject"><a class="viewcode-back" href="../connect.html#connect.VSDConnecter.downloadObject">[docs]</a>    <span class="k">def</span> <span class="nf">downloadObject</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="p">,</span> <span class="n">workingDir</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        download the object into a ZIP file based on the object name and the working directory</span>

<span class="sd">        :param APIObject obj: object</span>
<span class="sd">        :param Path workingDir: workpath, where to store the zip</span>
<span class="sd">        :return: None or filename</span>
<span class="sd">        :rtype: str</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">fp</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">name</span><span class="p">)</span><span class="o">.</span><span class="n">with_suffix</span><span class="p">(</span><span class="s1">&#39;.zip&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">workingDir</span><span class="p">:</span>
            <span class="n">fp</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">workingDir</span><span class="p">,</span> <span class="n">fp</span><span class="p">)</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_download</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fullUrl</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">downloadUrl</span><span class="p">),</span> <span class="n">fp</span><span class="o">.</span><span class="n">name</span><span class="p">)</span></div>

<div class="viewcode-block" id="VSDConnecter.downloadObjectPreviewImages"><a class="viewcode-back" href="../connect.html#connect.VSDConnecter.downloadObjectPreviewImages">[docs]</a>    <span class="k">def</span> <span class="nf">downloadObjectPreviewImages</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">object</span><span class="p">,</span> <span class="n">thumbnail</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="n">field</span> <span class="o">=</span> <span class="s1">&#39;thumbnailUrl&#39;</span> <span class="k">if</span> <span class="n">thumbnail</span> <span class="k">else</span> <span class="s1">&#39;imageUrl&#39;</span>
        <span class="n">embeddedImages</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">preview</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">object</span><span class="o">.</span><span class="n">objectPreviews</span><span class="p">):</span>
            <span class="n">p_obj</span> <span class="o">=</span> <span class="n">vsdModels</span><span class="o">.</span><span class="n">Preview</span><span class="p">(</span><span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">getRequest</span><span class="p">(</span><span class="n">preview</span><span class="o">.</span><span class="n">selfUrl</span><span class="p">))</span>
            <span class="n">img</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_requestsAttempts</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">s</span><span class="o">.</span><span class="n">get</span><span class="p">,</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">p_obj</span><span class="p">,</span> <span class="n">field</span><span class="p">))</span>
            <span class="n">embeddedImages</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">base64</span><span class="o">.</span><span class="n">b64encode</span><span class="p">(</span><span class="n">img</span><span class="o">.</span><span class="n">content</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">embeddedImages</span></div>

<div class="viewcode-block" id="VSDConnecter.getPaginated"><a class="viewcode-back" href="../connect.html#connect.VSDConnecter.getPaginated">[docs]</a>    <span class="k">def</span> <span class="nf">getPaginated</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">resource</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        get paginated object</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">res</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getRequest</span><span class="p">(</span><span class="n">resource</span><span class="p">)</span>
        <span class="n">page</span> <span class="o">=</span> <span class="n">vsdModels</span><span class="o">.</span><span class="n">Pagination</span><span class="p">(</span><span class="o">**</span><span class="n">res</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">page</span></div>

<div class="viewcode-block" id="VSDConnecter.getAllPaginated"><a class="viewcode-back" href="../connect.html#connect.VSDConnecter.getAllPaginated">[docs]</a>    <span class="k">def</span> <span class="nf">getAllPaginated</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">resource</span><span class="p">,</span> <span class="n">itemlist</span><span class="o">=</span><span class="nb">list</span><span class="p">()):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        returns all items as list</span>

<span class="sd">        :param str resource: resource path</span>
<span class="sd">        :param list itemlist: list of items</span>
<span class="sd">        :return: list of items</span>
<span class="sd">        :rtype: list of Pagination objects</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">res</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getRequest</span><span class="p">(</span><span class="n">resource</span><span class="p">)</span>
        <span class="n">page</span> <span class="o">=</span> <span class="n">vsdModels</span><span class="o">.</span><span class="n">Pagination</span><span class="p">(</span><span class="o">**</span><span class="n">res</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">page</span><span class="o">.</span><span class="n">items</span><span class="p">:</span>
            <span class="n">itemlist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">page</span><span class="o">.</span><span class="n">nextPageUrl</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">getAllPaginated</span><span class="p">(</span><span class="n">page</span><span class="o">.</span><span class="n">nextPageUrl</span><span class="p">,</span> <span class="n">itemlist</span><span class="o">=</span><span class="n">itemlist</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">itemlist</span></div>

<div class="viewcode-block" id="VSDConnecter.iteratePageItems"><a class="viewcode-back" href="../connect.html#connect.VSDConnecter.iteratePageItems">[docs]</a>    <span class="k">def</span> <span class="nf">iteratePageItems</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">page</span><span class="p">,</span> <span class="n">func</span><span class="o">=</span><span class="nb">dict</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        returns all items as list</span>

<span class="sd">        :param str resource: resource path</span>
<span class="sd">        :param func: function for converting resource</span>
<span class="sd">        :return: iterator of items</span>
<span class="sd">        :rtype: list of dict or model object</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">page</span><span class="o">.</span><span class="n">items</span><span class="p">:</span>
            <span class="k">yield</span> <span class="n">func</span><span class="p">(</span><span class="o">**</span><span class="n">item</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">page</span><span class="o">.</span><span class="n">nextPageUrl</span><span class="p">:</span>
            <span class="n">res</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getRequest</span><span class="p">(</span><span class="n">page</span><span class="o">.</span><span class="n">nextPageUrl</span><span class="p">)</span>
            <span class="n">nextPage</span> <span class="o">=</span> <span class="n">vsdModels</span><span class="o">.</span><span class="n">APIPagination</span><span class="p">(</span><span class="o">**</span><span class="n">res</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">nextItem</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">iteratePageItems</span><span class="p">(</span><span class="n">nextPage</span><span class="p">,</span> <span class="n">func</span><span class="o">=</span><span class="n">func</span><span class="p">):</span>
                <span class="k">yield</span> <span class="n">nextItem</span></div>

<div class="viewcode-block" id="VSDConnecter.iterateAllPaginated"><a class="viewcode-back" href="../connect.html#connect.VSDConnecter.iterateAllPaginated">[docs]</a>    <span class="k">def</span> <span class="nf">iterateAllPaginated</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">resource</span><span class="p">,</span> <span class="n">func</span><span class="o">=</span><span class="nb">dict</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        returns all items as list</span>

<span class="sd">        :param str resource: resource path</span>
<span class="sd">        :param func: function for converting resource</span>
<span class="sd">        :return: iterator of items</span>
<span class="sd">        :rtype: list of dict or model object</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">res</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getRequest</span><span class="p">(</span><span class="n">resource</span><span class="p">)</span>
        <span class="n">page</span> <span class="o">=</span> <span class="n">vsdModels</span><span class="o">.</span><span class="n">APIPagination</span><span class="p">(</span><span class="o">**</span><span class="n">res</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">iteratePageItems</span><span class="p">(</span><span class="n">page</span><span class="p">,</span> <span class="n">func</span><span class="p">):</span>
            <span class="k">yield</span> <span class="n">item</span></div>

<div class="viewcode-block" id="VSDConnecter.getObjects"><a class="viewcode-back" href="../connect.html#connect.VSDConnecter.getObjects">[docs]</a>    <span class="k">def</span> <span class="nf">getObjects</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">idList</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        please describe what you are doing</span>

<span class="sd">        :param ??? idList: ???</span>
<span class="sd">        :return:</span>
<span class="sd">        :rtype: </span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">idList</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">idList</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
        <span class="k">if</span> <span class="n">idList</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;published&#39;</span><span class="p">,</span> <span class="s1">&#39;unpublished&#39;</span><span class="p">]:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">iterateAllPaginated</span><span class="p">(</span><span class="s1">&#39;objects/</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">idList</span><span class="p">,</span> <span class="n">func</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">createObject</span><span class="p">)</span>

        <span class="n">items</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">curId</span> <span class="ow">in</span> <span class="n">idList</span><span class="p">:</span>
            <span class="n">items</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">getObject</span><span class="p">(</span><span class="n">curId</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">items</span></div>

<div class="viewcode-block" id="VSDConnecter.getOID"><a class="viewcode-back" href="../connect.html#connect.VSDConnecter.getOID">[docs]</a>    <span class="k">def</span> <span class="nf">getOID</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">selfURL</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        extracts the last part of the selfURL, tests if it is a number</span>

<span class="sd">        :param selfURL: (str) url to the object</span>
<span class="sd">        :return: either None if not an ID or the object ID (int)</span>
<span class="sd">        :raises: ValueError</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">selfURL_path</span> <span class="o">=</span> <span class="n">urllib</span><span class="o">.</span><span class="n">parse</span><span class="o">.</span><span class="n">urlsplit</span><span class="p">(</span><span class="n">selfURL</span><span class="p">)</span><span class="o">.</span><span class="n">path</span>
        <span class="n">oID</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">selfURL_path</span><span class="p">)</span><span class="o">.</span><span class="n">name</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">r</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">oID</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">ValueError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;no object ID in the selfUrl </span><span class="si">{0}</span><span class="s1">. Reason: </span><span class="si">{1}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">selfURL</span><span class="p">,</span> <span class="n">err</span><span class="p">))</span>
            <span class="n">r</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">return</span> <span class="n">r</span></div>

<div class="viewcode-block" id="VSDConnecter.getResourceTypeAndId"><a class="viewcode-back" href="../connect.html#connect.VSDConnecter.getResourceTypeAndId">[docs]</a>    <span class="k">def</span> <span class="nf">getResourceTypeAndId</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">url</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        please describe what you are doing</span>

<span class="sd">        :param:</span>
<span class="sd">        :return:</span>
<span class="sd">        :rtype: </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">url</span><span class="o">.</span><span class="n">rsplit</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">)[</span><span class="o">-</span><span class="mi">2</span><span class="p">:]</span></div>

    <span class="k">def</span> <span class="nf">_instantiateResource</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">res</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        please describe what you are doing</span>

<span class="sd">        :param:</span>
<span class="sd">        :return:</span>
<span class="sd">        :rtype: </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">pagination</span> <span class="o">=</span> <span class="n">vsdModels</span><span class="o">.</span><span class="n">Pagination</span><span class="p">(</span><span class="o">**</span><span class="n">res</span><span class="p">)</span>
            <span class="n">pagination</span><span class="o">.</span><span class="n">validate</span><span class="p">()</span> <span class="c1">#will fail if it doesno&#39;t have totalCount</span>
            <span class="k">return</span> <span class="n">pagination</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="n">resourcetype</span><span class="p">,</span> <span class="nb">id</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getResourceTypeAndId</span><span class="p">(</span><span class="n">res</span><span class="p">[</span><span class="s1">&#39;selfUrl&#39;</span><span class="p">])</span>
            <span class="k">if</span> <span class="n">resourcetype</span> <span class="o">==</span> <span class="s1">&#39;objects&#39;</span><span class="p">:</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">createObject</span><span class="p">(</span><span class="n">res</span><span class="p">)</span>
            <span class="n">model</span> <span class="o">=</span> <span class="n">vsdModels</span><span class="o">.</span><span class="n">resourceTypes</span><span class="p">[</span><span class="n">resourcetype</span><span class="p">](</span><span class="o">**</span><span class="n">res</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">model</span>

<div class="viewcode-block" id="VSDConnecter.getResource"><a class="viewcode-back" href="../connect.html#connect.VSDConnecter.getResource">[docs]</a>    <span class="k">def</span> <span class="nf">getResource</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">url</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        please describe what you are doing</span>

<span class="sd">        :param:</span>
<span class="sd">        :return:</span>
<span class="sd">        :rtype: </span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">res</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getRequest</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_instantiateResource</span><span class="p">(</span><span class="n">res</span><span class="p">)</span></div>



<div class="viewcode-block" id="VSDConnecter.getObject"><a class="viewcode-back" href="../connect.html#connect.VSDConnecter.getObject">[docs]</a>    <span class="k">def</span> <span class="nf">getObject</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">resource</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;retrieve an object based on the objectID/selfUrl</span>

<span class="sd">        :param int,str resource: (str) selfUrl of the object or the (int) object ID</span>
<span class="sd">        :return: the object</span>
<span class="sd">        :rtype: APIObject</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">resource</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parseUrl</span><span class="p">(</span><span class="n">resource</span><span class="p">,</span> <span class="s1">&#39;objects&#39;</span><span class="p">)</span>

        <span class="n">res</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getRequest</span><span class="p">(</span><span class="n">resource</span><span class="p">)</span>
        <span class="n">obj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">createObject</span><span class="p">(</span><span class="n">res</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">obj</span></div>

<div class="viewcode-block" id="VSDConnecter.getFolder"><a class="viewcode-back" href="../connect.html#connect.VSDConnecter.getFolder">[docs]</a>    <span class="k">def</span> <span class="nf">getFolder</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">resource</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;retrieve an folder based on the folderID/selfUrl</span>

<span class="sd">        :param int,str resource: (str) selfUrl of the folder or the (int) folder ID</span>
<span class="sd">        :return: the folder</span>
<span class="sd">        :rtype: APIFolder</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">resource</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parseUrl</span><span class="p">(</span><span class="n">resource</span><span class="p">,</span> <span class="s1">&#39;folders&#39;</span><span class="p">)</span>
        <span class="n">res</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getRequest</span><span class="p">(</span><span class="n">resource</span><span class="p">)</span>
        <span class="n">folder</span> <span class="o">=</span> <span class="n">vsdModels</span><span class="o">.</span><span class="n">Folder</span><span class="p">(</span><span class="o">**</span><span class="n">res</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">folder</span></div>

<div class="viewcode-block" id="VSDConnecter.getObjectFilesHash"><a class="viewcode-back" href="../connect.html#connect.VSDConnecter.getObjectFilesHash">[docs]</a>    <span class="k">def</span> <span class="nf">getObjectFilesHash</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        retrieve the filehash and the anonymized file hash values of a file</span>

<span class="sd">        :param APIObject f: API object</span>
<span class="sd">        :return: list of fileHash (uppercase)</span>
<span class="sd">        :rtype: list of str</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">filehash</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>

        <span class="n">files</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getObjectFiles</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">files</span><span class="p">:</span>
            <span class="n">filehash</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">fileHashCode</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">filehash</span></div>

<div class="viewcode-block" id="VSDConnecter.walkFolder"><a class="viewcode-back" href="../connect.html#connect.VSDConnecter.walkFolder">[docs]</a>    <span class="k">def</span> <span class="nf">walkFolder</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">folderUrl</span><span class="p">,</span> <span class="n">topdown</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        please describe here</span>

<span class="sd">        :param:</span>
<span class="sd">        :return:</span>
<span class="sd">        :rtype:</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># similar to os.walk</span>
        <span class="n">folderObject</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getFolder</span><span class="p">(</span><span class="n">folderUrl</span><span class="p">)</span>
        <span class="n">dirs</span> <span class="o">=</span> <span class="n">folderObject</span><span class="o">.</span><span class="n">childFolders</span>
        <span class="n">nondirs</span> <span class="o">=</span> <span class="n">folderObject</span><span class="o">.</span><span class="n">containedObjects</span>
        <span class="k">if</span> <span class="n">dirs</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">dirs</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="n">nondirs</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">nondirs</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="n">topdown</span><span class="p">:</span>
            <span class="k">yield</span> <span class="n">folderObject</span><span class="p">,</span> <span class="n">dirs</span><span class="p">,</span> <span class="n">nondirs</span>

        <span class="k">for</span> <span class="n">nextDir</span> <span class="ow">in</span> <span class="n">dirs</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">walkFolder</span><span class="p">(</span><span class="n">nextDir</span><span class="o">.</span><span class="n">selfUrl</span><span class="p">):</span>
                <span class="k">yield</span> <span class="n">x</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">topdown</span><span class="p">:</span>
            <span class="k">yield</span> <span class="n">folderObject</span><span class="p">,</span> <span class="n">dirs</span><span class="p">,</span> <span class="n">nondirs</span></div>

<div class="viewcode-block" id="VSDConnecter.checkFileInObject"><a class="viewcode-back" href="../connect.html#connect.VSDConnecter.checkFileInObject">[docs]</a>    <span class="k">def</span> <span class="nf">checkFileInObject</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="p">,</span> <span class="n">fp</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        check if a local file is part of an object</span>

<span class="sd">        :param APIObject obj: API object</span>
<span class="sd">        :param Path fp: file to test</span>
<span class="sd">        :return: if contained or not</span>
<span class="sd">        :rtype: bool</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">containted</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="c1">## Haso of all files</span>
        <span class="n">filehash</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getObjectFilesHash</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span>

        <span class="c1">## Local hash</span>
        <span class="n">BLOCKSIZE</span> <span class="o">=</span> <span class="mi">65536</span>
        <span class="n">hasher</span> <span class="o">=</span> <span class="n">hashlib</span><span class="o">.</span><span class="n">sha1</span><span class="p">()</span>

        <span class="k">with</span> <span class="n">fp</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s1">&#39;rb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">afile</span><span class="p">:</span>
            <span class="n">buf</span> <span class="o">=</span> <span class="n">afile</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">BLOCKSIZE</span><span class="p">)</span>
            <span class="k">while</span> <span class="nb">len</span><span class="p">(</span><span class="n">buf</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">hasher</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">buf</span><span class="p">)</span>
                <span class="n">buf</span> <span class="o">=</span> <span class="n">afile</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">BLOCKSIZE</span><span class="p">)</span>
        <span class="n">localhash</span> <span class="o">=</span> <span class="n">hasher</span><span class="o">.</span><span class="n">hexdigest</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">localhash</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span> <span class="ow">in</span> <span class="n">filehash</span><span class="p">:</span>
            <span class="n">containted</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="k">return</span> <span class="n">containted</span></div>

<div class="viewcode-block" id="VSDConnecter.searchTerm"><a class="viewcode-back" href="../connect.html#connect.VSDConnecter.searchTerm">[docs]</a>    <span class="k">def</span> <span class="nf">searchTerm</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">resource</span><span class="p">,</span> <span class="n">search</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;default&#39;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; search a resource using oAuths</span>

<span class="sd">        :param str resouce: resource path</span>
<span class="sd">        :param str search: term to search for</span>
<span class="sd">        :param str mode: search for partial match (default) or exact match (exact)</span>
<span class="sd">        :return: list of folder objects</span>
<span class="sd">        :rtype: json</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">search</span> <span class="o">=</span> <span class="n">urlparse_quote</span><span class="p">(</span><span class="n">search</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">mode</span> <span class="o">==</span> <span class="s1">&#39;exact&#39;</span><span class="p">:</span>
            <span class="n">url</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fullUrl</span><span class="p">(</span><span class="n">resource</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;?$filter=Term</span><span class="si">%20e</span><span class="s1">q</span><span class="si">%20%</span><span class="s1">27</span><span class="si">{0}</span><span class="s1">%27&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">search</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">url</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fullUrl</span><span class="p">(</span><span class="n">resource</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;?$filter=startswith(Term,%27</span><span class="si">{0}</span><span class="s1">%27)</span><span class="si">%20e</span><span class="s1">q%20true&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">search</span><span class="p">)</span>

        <span class="n">req</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getRequest</span><span class="p">(</span><span class="n">url</span><span class="p">)</span></div>
        <span class="c1">#return req.json()</span>
    

<div class="viewcode-block" id="VSDConnecter.getFile"><a class="viewcode-back" href="../connect.html#connect.VSDConnecter.getFile">[docs]</a>    <span class="k">def</span> <span class="nf">getFile</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">resource</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        return a APIFile object</span>

<span class="sd">        :param str resource: resource path</span>
<span class="sd">        :return: api file object  or status code</span>
<span class="sd">        :rtype: APIFile</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">resource</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parseUrl</span><span class="p">(</span><span class="n">resource</span><span class="p">,</span> <span class="s1">&#39;files&#39;</span><span class="p">)</span>

        <span class="n">res</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getRequest</span><span class="p">(</span><span class="n">resource</span><span class="p">)</span>
        <span class="n">fObj</span> <span class="o">=</span> <span class="n">vsdModels</span><span class="o">.</span><span class="n">File</span><span class="p">(</span><span class="o">**</span><span class="n">res</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">fObj</span></div>

<div class="viewcode-block" id="VSDConnecter.getObjectFiles"><a class="viewcode-back" href="../connect.html#connect.VSDConnecter.getObjectFiles">[docs]</a>    <span class="k">def</span> <span class="nf">getObjectFiles</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        return a list of file objects contained in an object</span>

<span class="sd">        :param APIObject obj: object</span>
<span class="sd">        :return: list of APIFile</span>
<span class="sd">        :rtype: list of APIFile</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">filelist</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>

        <span class="n">fileurl</span> <span class="o">=</span> <span class="s1">&#39;objects/</span><span class="si">{0}</span><span class="s1">/files&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">id</span><span class="p">)</span>

        <span class="n">fl</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">iterateAllPaginated</span><span class="p">(</span><span class="n">fileurl</span><span class="p">)</span>
        <span class="c1">#fl = self.getAllPaginated(fileurl) </span>

        <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">fl</span><span class="p">:</span>
            <span class="n">res</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getFile</span><span class="p">(</span><span class="n">f</span><span class="p">[</span><span class="s1">&#39;selfUrl&#39;</span><span class="p">])</span>
            <span class="n">filelist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">res</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">filelist</span></div>

<div class="viewcode-block" id="VSDConnecter.fileObjectVersion"><a class="viewcode-back" href="../connect.html#connect.VSDConnecter.fileObjectVersion">[docs]</a>    <span class="k">def</span> <span class="nf">fileObjectVersion</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Extract VSDID and selfUrl of the related Object Version of the file after file upload</span>

<span class="sd">        :param json data: file object data</span>
<span class="sd">        :result: returns the id and the selfUrl of the Object Version</span>
<span class="sd">        :rtype: str</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># data = json.loads(data)</span>
        <span class="n">f</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;file&#39;</span><span class="p">]</span>
        <span class="n">obj</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;relatedObject&#39;</span><span class="p">]</span>
        <span class="n">fSelfUrl</span> <span class="o">=</span> <span class="n">f</span><span class="p">[</span><span class="s1">&#39;selfUrl&#39;</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">obj</span><span class="p">[</span><span class="s1">&#39;selfUrl&#39;</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">getOID</span><span class="p">(</span><span class="n">obj</span><span class="p">[</span><span class="s1">&#39;selfUrl&#39;</span><span class="p">])</span></div>

<div class="viewcode-block" id="VSDConnecter.getAllUnpublishedObjects"><a class="viewcode-back" href="../connect.html#connect.VSDConnecter.getAllUnpublishedObjects">[docs]</a>    <span class="k">def</span> <span class="nf">getAllUnpublishedObjects</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">resource</span><span class="o">=</span><span class="s1">&#39;objects/unpublished&#39;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; retrieve the unpublished objects as list of APIObject</span>

<span class="sd">        :param str resource: resource path (eg nextPageUrl) or default groups</span>
<span class="sd">        :param int rpp: results per page</span>
<span class="sd">        :param int page: page to display</span>
<span class="sd">        :return: list of objects</span>
<span class="sd">        :rtype: APIObjects</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">objects</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>

        <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">iterateAllPaginated</span><span class="p">(</span><span class="n">resource</span><span class="p">,</span> <span class="n">vsdModels</span><span class="o">.</span><span class="n">APIObject</span><span class="p">):</span>
            <span class="n">obj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getObject</span><span class="p">(</span><span class="n">item</span><span class="o">.</span><span class="n">selfUrl</span><span class="p">)</span>
            <span class="n">objects</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">objects</span></div>

<div class="viewcode-block" id="VSDConnecter.getLatestUnpublishedObject"><a class="viewcode-back" href="../connect.html#connect.VSDConnecter.getLatestUnpublishedObject">[docs]</a>    <span class="k">def</span> <span class="nf">getLatestUnpublishedObject</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        searches the list of unpublished objects and returns the newest object</span>

<span class="sd">        :return: last uploaded object</span>
<span class="sd">        :rtype: apiObject</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">res</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getRequest</span><span class="p">(</span><span class="s1">&#39;objects/unpublished&#39;</span><span class="p">)</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">res</span><span class="p">[</span><span class="s1">&#39;items&#39;</span><span class="p">])</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">obj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getObject</span><span class="p">(</span><span class="n">res</span><span class="p">[</span><span class="s1">&#39;items&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;selfUrl&#39;</span><span class="p">))</span>
            <span class="k">return</span> <span class="n">obj</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;you have no unpublished objects&#39;</span><span class="p">)</span>
            <span class="k">return</span> <span class="kc">None</span></div>

<div class="viewcode-block" id="VSDConnecter.getFolderByName"><a class="viewcode-back" href="../connect.html#connect.VSDConnecter.getFolderByName">[docs]</a>    <span class="k">def</span> <span class="nf">getFolderByName</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">search</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;default&#39;</span><span class="p">,</span> <span class="n">squeeze</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        get a list of folder(s) based on a search string</span>

<span class="sd">        :param str search: term to search for</span>
<span class="sd">        :param str mode: search for partial match (&#39;default&#39;) or exact match (&#39;exact&#39;)</span>
<span class="sd">        :param bool squeeze: ???? what is squeeze</span>
<span class="sd">        :return: list of folder objects APIFolders</span>
<span class="sd">        :rtype: list of APIFolders</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">search</span> <span class="o">=</span> <span class="n">urlparse_quote</span><span class="p">(</span><span class="n">search</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">mode</span> <span class="o">==</span> <span class="s1">&#39;exact&#39;</span><span class="p">:</span>

            <span class="n">url</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">url</span> <span class="o">+</span> <span class="s2">&quot;folders?$filter=Name</span><span class="si">%20e</span><span class="s2">q</span><span class="si">%20%</span><span class="s2">27</span><span class="si">{0}</span><span class="s2">%27&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">search</span><span class="p">)</span>

        <span class="k">else</span><span class="p">:</span>

            <span class="n">url</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">url</span> <span class="o">+</span> <span class="s2">&quot;folders?$filter=startswith(Name,%27</span><span class="si">{0}</span><span class="s2">%27)</span><span class="si">%20e</span><span class="s2">q%20true&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">search</span><span class="p">)</span>

        <span class="n">result</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">iterateAllPaginated</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">vsdModels</span><span class="o">.</span><span class="n">APIFolder</span><span class="p">))</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">result</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">squeeze</span><span class="p">:</span>
            <span class="n">folder</span> <span class="o">=</span> <span class="n">result</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;1 folder matching the search found&#39;</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">folder</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;list of </span><span class="si">{}</span><span class="s1"> folders matching the search found&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">result</span><span class="p">)))</span>
            <span class="k">return</span> <span class="n">result</span></div>

<div class="viewcode-block" id="VSDConnecter.getContainedFolders"><a class="viewcode-back" href="../connect.html#connect.VSDConnecter.getContainedFolders">[docs]</a>    <span class="k">def</span> <span class="nf">getContainedFolders</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">folder</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        return a list of folder object contained in a folder</span>

<span class="sd">        :param APIFolder folder: folder object</span>
<span class="sd">        :return folderlist: a list of folder object (APIFolder) contained in the folder</span>
<span class="sd">        :rtype: list of APIFolder</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">folderlist</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">folder</span><span class="o">.</span><span class="n">childFolders</span><span class="p">:</span>

            <span class="k">for</span> <span class="n">fold</span> <span class="ow">in</span> <span class="n">folder</span><span class="o">.</span><span class="n">childFolders</span><span class="p">:</span>
                <span class="n">basic</span> <span class="o">=</span> <span class="n">vsdModels</span><span class="o">.</span><span class="n">APIBase</span><span class="p">(</span><span class="o">**</span><span class="n">fold</span><span class="p">)</span>
                <span class="n">f</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getFolder</span><span class="p">(</span><span class="n">basic</span><span class="o">.</span><span class="n">selfUrl</span><span class="p">)</span>
                <span class="n">folderlist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">folderlist</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;the folder does not have any contained folders&#39;</span><span class="p">)</span>
            <span class="k">return</span> <span class="kc">None</span></div>

<div class="viewcode-block" id="VSDConnecter.getContainedObjects"><a class="viewcode-back" href="../connect.html#connect.VSDConnecter.getContainedObjects">[docs]</a>    <span class="k">def</span> <span class="nf">getContainedObjects</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">folder</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        return a list of object contained in a folder</span>

<span class="sd">        :param APIFolder folder: folder object</span>
<span class="sd">        :return objlist: a list of objects (APIFObject) contained in the folder</span>
<span class="sd">        :rtype:  list of APIObject</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">objlist</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">folder</span><span class="o">.</span><span class="n">containedObjects</span><span class="p">:</span>

            <span class="k">for</span> <span class="n">obj</span> <span class="ow">in</span> <span class="n">folder</span><span class="o">.</span><span class="n">containedObjects</span><span class="p">:</span>
                <span class="n">basic</span> <span class="o">=</span> <span class="n">vsdModels</span><span class="o">.</span><span class="n">APIBase</span><span class="p">(</span><span class="o">**</span><span class="n">obj</span><span class="p">)</span>
                <span class="n">o</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getObject</span><span class="p">(</span><span class="n">basic</span><span class="o">.</span><span class="n">selfUrl</span><span class="p">)</span>
                <span class="n">objlist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">o</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">objlist</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;the folder does not have any contained objects&#39;</span><span class="p">)</span>
            <span class="k">return</span> <span class="kc">None</span></div>

<div class="viewcode-block" id="VSDConnecter.getModalityList"><a class="viewcode-back" href="../connect.html#connect.VSDConnecter.getModalityList">[docs]</a>    <span class="k">def</span> <span class="nf">getModalityList</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        retrieve a list of modalities objects (APIModality)</span>

<span class="sd">        :return: list of available modalities</span>
<span class="sd">        :rtype: list of Modality</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">modalities</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
        <span class="n">items</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">iterateAllPaginated</span><span class="p">(</span><span class="s1">&#39;modalities&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">items</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">items</span><span class="p">:</span>
                <span class="n">modality</span> <span class="o">=</span> <span class="n">vsdModels</span><span class="o">.</span><span class="n">Modality</span><span class="p">(</span><span class="o">**</span><span class="n">item</span><span class="p">)</span>
                <span class="n">modalities</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">modality</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">modalities</span></div>

<div class="viewcode-block" id="VSDConnecter.getModality"><a class="viewcode-back" href="../connect.html#connect.VSDConnecter.getModality">[docs]</a>    <span class="k">def</span> <span class="nf">getModality</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">resource</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; retrieve a modalities object (APIModality)</span>


<span class="sd">        :param int,str resource: resource path to the of the modality</span>
<span class="sd">        :return: the modality object</span>
<span class="sd">        :rtype: Modality</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">resource</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parseUrl</span><span class="p">(</span><span class="n">resource</span><span class="p">,</span> <span class="s1">&#39;modalities&#39;</span><span class="p">)</span>

        <span class="n">res</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getRequest</span><span class="p">(</span><span class="n">resource</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">vsdModels</span><span class="o">.</span><span class="n">Modality</span><span class="p">(</span><span class="o">**</span><span class="n">res</span><span class="p">)</span></div>



<div class="viewcode-block" id="VSDConnecter.getFolderContent"><a class="viewcode-back" href="../connect.html#connect.VSDConnecter.getFolderContent">[docs]</a>    <span class="k">def</span> <span class="nf">getFolderContent</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">folder</span><span class="p">,</span> <span class="n">recursive</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;d&#39;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        get the objects and folder contained in the given folder. can be called recursive to travel and return all objects</span>

<span class="sd">        :param APIFolder folder: the folder to be read</span>
<span class="sd">        :param bool recursive:  travel the folder structure recursively or not (default)</span>
<span class="sd">        :param str mode: what to return: only objects (o), only folders (f) or default (d) folders and objects</span>
<span class="sd">        :return content: dictionary with folders (APIBase) and object (APIBase)</span>
<span class="sd">        :rtype: dict of APIBase</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">objectmode</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="n">foldermode</span> <span class="o">=</span> <span class="kc">False</span>

        <span class="k">if</span> <span class="n">mode</span> <span class="o">==</span> <span class="s1">&#39;o&#39;</span><span class="p">:</span>
            <span class="n">objectmode</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="k">elif</span> <span class="n">mode</span> <span class="o">==</span> <span class="s1">&#39;f&#39;</span><span class="p">:</span>
            <span class="n">foldermode</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="k">elif</span> <span class="n">mode</span> <span class="o">==</span> <span class="s1">&#39;d&#39;</span><span class="p">:</span>
            <span class="n">objectmode</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="n">foldermode</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;mode </span><span class="si">{0}</span><span class="s1"> not supported&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">mode</span><span class="p">))</span>

        <span class="n">folders</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getContainedFolders</span><span class="p">(</span><span class="n">folder</span><span class="p">)</span>

        <span class="n">temp</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">([(</span><span class="s1">&#39;folder&#39;</span><span class="p">,</span> <span class="n">folder</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;object&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)])</span>

        <span class="k">if</span> <span class="n">foldermode</span><span class="p">:</span>
            <span class="n">content</span> <span class="o">=</span> <span class="nb">list</span><span class="p">([</span><span class="n">temp</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">content</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">objectmode</span><span class="p">:</span>
            <span class="n">objects</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getContainedObjects</span><span class="p">(</span><span class="n">folder</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">objects</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">obj</span> <span class="ow">in</span> <span class="n">objects</span><span class="p">:</span>
                    <span class="n">temp</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">([(</span><span class="s1">&#39;folder&#39;</span><span class="p">,</span> <span class="n">folder</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;object&#39;</span><span class="p">,</span> <span class="n">obj</span><span class="p">)])</span>
                    <span class="n">content</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">temp</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">folders</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">recursive</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">fold</span> <span class="ow">in</span> <span class="n">folders</span><span class="p">:</span>
                    <span class="n">content</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">getFolderContent</span><span class="p">(</span><span class="n">fold</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="n">mode</span><span class="p">,</span> <span class="n">recursive</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>

            <span class="k">else</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">foldermode</span><span class="p">:</span>
                    <span class="k">for</span> <span class="n">fold</span> <span class="ow">in</span> <span class="n">folders</span><span class="p">:</span>
                        <span class="n">temp</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">([(</span><span class="s1">&#39;folder&#39;</span><span class="p">,</span> <span class="n">folder</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;object&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)])</span>
                        <span class="n">content</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">temp</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">content</span></div>

<div class="viewcode-block" id="VSDConnecter.searchOntologyTerm"><a class="viewcode-back" href="../connect.html#connect.VSDConnecter.searchOntologyTerm">[docs]</a>    <span class="k">def</span> <span class="nf">searchOntologyTerm</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">search</span><span class="p">,</span> <span class="n">oType</span><span class="o">=</span><span class="s1">&#39;0&#39;</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;default&#39;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Search ontology term in a single ontology resource. Two modes are available to either find the exact term or based on a partial match</span>

<span class="sd">        :param str search: string to be searched</span>
<span class="sd">        :param int oType: ontlogy resouce code, default is FMA (0)</span>
<span class="sd">        :param str mode: find exact term (exact) or partial match (default)</span>
<span class="sd">        :returns: a list of ontology objects or a single ontology item</span>
<span class="sd">        :rtype: APIOntolgy</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">search</span> <span class="o">=</span> <span class="n">urlparse_quote</span><span class="p">(</span><span class="n">search</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">mode</span> <span class="o">==</span> <span class="s1">&#39;exact&#39;</span><span class="p">:</span>
            <span class="n">url</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">url</span> <span class="o">+</span> <span class="s2">&quot;ontologies/</span><span class="si">{0}</span><span class="s2">?$filter=Term</span><span class="si">%20e</span><span class="s2">q</span><span class="si">%20%</span><span class="s2">27</span><span class="si">{1}</span><span class="s2">%27&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">oType</span><span class="p">,</span> <span class="n">search</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">url</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">url</span> <span class="o">+</span> <span class="s2">&quot;ontologies/</span><span class="si">{0}</span><span class="s2">?$filter=startswith(Term,%27</span><span class="si">{1}</span><span class="s2">%27)</span><span class="si">%20e</span><span class="s2">q%20true&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">oType</span><span class="p">,</span> <span class="n">search</span><span class="p">)</span>

        <span class="n">res</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">res</span><span class="o">.</span><span class="n">status_code</span> <span class="o">==</span> <span class="n">requests</span><span class="o">.</span><span class="n">codes</span><span class="o">.</span><span class="n">ok</span><span class="p">:</span>
            <span class="n">result</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>

            <span class="n">res</span> <span class="o">=</span> <span class="n">res</span><span class="o">.</span><span class="n">json</span><span class="p">()</span>

            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">res</span><span class="p">[</span><span class="s1">&#39;items&#39;</span><span class="p">])</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">onto</span> <span class="o">=</span> <span class="n">vsdModels</span><span class="o">.</span><span class="n">Ontology</span><span class="p">()</span>
                <span class="n">onto</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">res</span><span class="p">[</span><span class="s1">&#39;items&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;1 ontology term matching the search found&#39;</span><span class="p">)</span>
                <span class="k">return</span> <span class="n">onto</span>
            <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="nb">iter</span><span class="p">(</span><span class="n">res</span><span class="p">[</span><span class="s1">&#39;items&#39;</span><span class="p">]):</span>
                <span class="n">onto</span> <span class="o">=</span> <span class="n">vsdModels</span><span class="o">.</span><span class="n">Ontology</span><span class="p">()</span>
                <span class="n">onto</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
                <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">onto</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">result</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">res</span><span class="o">.</span><span class="n">status_code</span></div>

<div class="viewcode-block" id="VSDConnecter.getOntologyTermByID"><a class="viewcode-back" href="../connect.html#connect.VSDConnecter.getOntologyTermByID">[docs]</a>    <span class="k">def</span> <span class="nf">getOntologyTermByID</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">oid</span><span class="p">,</span> <span class="n">oType</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Retrieve an ontology entry based on the IRI</span>

<span class="sd">        :param int oid: Identifier of the entry</span>
<span class="sd">        :param int oType: Resource type, available resources can be found using the OPTIONS on /api/ontologies). Default resouce is FMA (0)</span>
<span class="sd">        :return: ontology term entry</span>
<span class="sd">        :rtype: json</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;ontologies/</span><span class="si">{0}</span><span class="s2">/</span><span class="si">{1}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">oType</span><span class="p">,</span> <span class="n">oid</span><span class="p">)</span>
        <span class="n">req</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getRequest</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">req</span><span class="o">.</span><span class="n">json</span><span class="p">()</span></div>

<div class="viewcode-block" id="VSDConnecter.getOntologyItem"><a class="viewcode-back" href="../connect.html#connect.VSDConnecter.getOntologyItem">[docs]</a>    <span class="k">def</span> <span class="nf">getOntologyItem</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">resource</span><span class="p">,</span> <span class="n">oType</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Retrieve an ontology item object (APIOntology)</span>

<span class="sd">        :param int,str resource: resource path to the of the ontology item</span>
<span class="sd">        :param int oType: ontology type</span>
<span class="sd">        :return onto: the ontology item object</span>
<span class="sd">        :rtype: Ontology</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">resource</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
            <span class="n">resource</span> <span class="o">=</span> <span class="s1">&#39;ontology/</span><span class="si">{0}</span><span class="s1">/</span><span class="si">{1}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">resource</span><span class="p">,</span> <span class="n">oType</span><span class="p">)</span>

        <span class="n">res</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getRequest</span><span class="p">(</span><span class="n">resource</span><span class="p">)</span>
        <span class="n">onto</span> <span class="o">=</span> <span class="n">vsdModels</span><span class="o">.</span><span class="n">Ontology</span><span class="p">(</span><span class="o">**</span><span class="n">res</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">onto</span></div>

<div class="viewcode-block" id="VSDConnecter.getLicenseList"><a class="viewcode-back" href="../connect.html#connect.VSDConnecter.getLicenseList">[docs]</a>    <span class="k">def</span> <span class="nf">getLicenseList</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; retrieve a list of the available licenses (License)</span>


<span class="sd">        :return: list of available license objects</span>
<span class="sd">        :rtype: list of License</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">res</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getRequest</span><span class="p">(</span><span class="s1">&#39;licenses&#39;</span><span class="p">)</span>
        <span class="n">licenses</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">res</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="nb">iter</span><span class="p">(</span><span class="n">res</span><span class="p">[</span><span class="s1">&#39;items&#39;</span><span class="p">]):</span>
                <span class="n">lic</span> <span class="o">=</span> <span class="n">vsdModels</span><span class="o">.</span><span class="n">License</span><span class="p">(</span><span class="o">**</span><span class="n">item</span><span class="p">)</span>
                <span class="n">licenses</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">lic</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">licenses</span></div>

<div class="viewcode-block" id="VSDConnecter.getLicense"><a class="viewcode-back" href="../connect.html#connect.VSDConnecter.getLicense">[docs]</a>    <span class="k">def</span> <span class="nf">getLicense</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">resource</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; retrieve a license (License)</span>

<span class="sd">        :param int,str resource: resource path to the of the license</span>
<span class="sd">        :return license: the license object</span>
<span class="sd">        :rtype: License</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">resource</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
            <span class="n">resource</span> <span class="o">=</span> <span class="s1">&#39;licenses/</span><span class="si">{0}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">resource</span><span class="p">)</span>

        <span class="n">res</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getRequest</span><span class="p">(</span><span class="n">resource</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">res</span><span class="p">:</span>
            <span class="n">license</span> <span class="o">=</span> <span class="n">vsdModels</span><span class="o">.</span><span class="n">License</span><span class="p">(</span><span class="o">**</span><span class="n">res</span><span class="p">)</span>

            <span class="k">return</span> <span class="n">license</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span></div>

<div class="viewcode-block" id="VSDConnecter.getObjectRightList"><a class="viewcode-back" href="../connect.html#connect.VSDConnecter.getObjectRightList">[docs]</a>    <span class="k">def</span> <span class="nf">getObjectRightList</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; retrieve a list of the available base object rights (ObjectRight)</span>

<span class="sd">        :return: list of object rights</span>
<span class="sd">        :rtype: list of ObjectRight</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">res</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getRequest</span><span class="p">(</span><span class="s1">&#39;object_rights&#39;</span><span class="p">)</span>
        <span class="n">permission</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">res</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="nb">iter</span><span class="p">(</span><span class="n">res</span><span class="p">[</span><span class="s1">&#39;items&#39;</span><span class="p">]):</span>
                <span class="n">perm</span> <span class="o">=</span> <span class="n">vsdModels</span><span class="o">.</span><span class="n">ObjectRight</span><span class="p">(</span><span class="o">**</span><span class="n">item</span><span class="p">)</span>
                <span class="n">permission</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">perm</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">permission</span></div>

<div class="viewcode-block" id="VSDConnecter.getObjectRight"><a class="viewcode-back" href="../connect.html#connect.VSDConnecter.getObjectRight">[docs]</a>    <span class="k">def</span> <span class="nf">getObjectRight</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">resource</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; retrieve a  object rights object (ObjectRight)</span>

<span class="sd">        :param int,str resource: resource to the permission id (int) or selfurl (str)</span>
<span class="sd">        :return: perm object</span>
<span class="sd">        :rtype: ObjectRight</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">resource</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
            <span class="n">resource</span> <span class="o">=</span> <span class="s1">&#39;object_rights/</span><span class="si">{0}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">resource</span><span class="p">)</span>
        <span class="n">res</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getRequest</span><span class="p">(</span><span class="n">resource</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">res</span><span class="p">:</span>
            <span class="n">perm</span> <span class="o">=</span> <span class="n">vsdModels</span><span class="o">.</span><span class="n">ObjectRight</span><span class="p">()</span>
            <span class="n">perm</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">obj</span><span class="o">=</span><span class="n">res</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">perm</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span></div>

<div class="viewcode-block" id="VSDConnecter.getGroups"><a class="viewcode-back" href="../connect.html#connect.VSDConnecter.getGroups">[docs]</a>    <span class="k">def</span> <span class="nf">getGroups</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">resource</span><span class="o">=</span><span class="s1">&#39;groups&#39;</span><span class="p">,</span> <span class="n">rpp</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">page</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;get the list of groups</span>

<span class="sd">        :param str resource: resource path (eg nextPageUrl) or default groups</span>
<span class="sd">        :param int rpp: results per page</span>
<span class="sd">        :param int page: page number to display</span>
<span class="sd">        :return: list of group objects</span>
<span class="sd">        :rtype: Group</span>
<span class="sd">        :return: pagination object</span>
<span class="sd">        :rtype: Pagination</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">groups</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
        <span class="n">res</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getRequest</span><span class="p">(</span><span class="n">resource</span><span class="p">,</span> <span class="n">rpp</span><span class="p">,</span> <span class="n">page</span><span class="p">)</span>
        <span class="n">ppObj</span> <span class="o">=</span> <span class="n">vsdModels</span><span class="o">.</span><span class="n">Pagination</span><span class="p">(</span><span class="o">**</span><span class="n">res</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">g</span> <span class="ow">in</span> <span class="n">ppObj</span><span class="o">.</span><span class="n">items</span><span class="p">:</span>
            <span class="n">group</span> <span class="o">=</span> <span class="n">vsdModels</span><span class="o">.</span><span class="n">Group</span><span class="p">(</span><span class="o">**</span><span class="n">g</span><span class="p">)</span>
            <span class="n">groups</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">group</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">groups</span><span class="p">,</span> <span class="n">ppObj</span></div>


<div class="viewcode-block" id="VSDConnecter.getGroup"><a class="viewcode-back" href="../connect.html#connect.VSDConnecter.getGroup">[docs]</a>    <span class="k">def</span> <span class="nf">getGroup</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">resource</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; retrieve a group object (Group)</span>

<span class="sd">        :param int,str resource: path to the group id (int) or selfUrl (str)</span>
<span class="sd">        :return: group  object</span>
<span class="sd">        :rtype: Group</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">resource</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
            <span class="n">resource</span> <span class="o">=</span> <span class="s1">&#39;groups/</span><span class="si">{0}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">resource</span><span class="p">)</span>

        <span class="n">res</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getRequest</span><span class="p">(</span><span class="n">resource</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">res</span><span class="p">:</span>
            <span class="n">group</span> <span class="o">=</span> <span class="n">vsdModels</span><span class="o">.</span><span class="n">Group</span><span class="p">()</span>
            <span class="n">group</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">obj</span><span class="o">=</span><span class="n">res</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">group</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span></div>

<div class="viewcode-block" id="VSDConnecter.getUser"><a class="viewcode-back" href="../connect.html#connect.VSDConnecter.getUser">[docs]</a>    <span class="k">def</span> <span class="nf">getUser</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">resource</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; retrieve a user object (User)</span>

<span class="sd">        :param int,str resource: path to the user resource id (int) or selfUrl (str)</span>
<span class="sd">        :return: user object</span>
<span class="sd">        :rtype: User</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">resource</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
            <span class="n">resource</span> <span class="o">=</span> <span class="s1">&#39;users/</span><span class="si">{0}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">resource</span><span class="p">)</span>

        <span class="n">res</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getRequest</span><span class="p">(</span><span class="n">resource</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">res</span><span class="p">:</span>
            <span class="n">user</span> <span class="o">=</span> <span class="n">vsdModels</span><span class="o">.</span><span class="n">User</span><span class="p">(</span><span class="o">**</span><span class="n">res</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">user</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span></div>

<div class="viewcode-block" id="VSDConnecter.getPermissionSets"><a class="viewcode-back" href="../connect.html#connect.VSDConnecter.getPermissionSets">[docs]</a>    <span class="k">def</span> <span class="nf">getPermissionSets</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">permset</span><span class="o">=</span><span class="s1">&#39;default&#39;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        get the Object Rights for a permission set</span>

<span class="sd">        :param str permset: name of the permission set: available are private, protect, default, collaborate, full or a list of permission ids (list)</span>
<span class="sd">        :return perms: list of object rights objects</span>
<span class="sd">        :rtype: OjectRight</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">permset</span> <span class="o">==</span> <span class="s1">&#39;private&#39;</span><span class="p">:</span>
            <span class="n">lperms</span> <span class="o">=</span> <span class="nb">list</span><span class="p">([</span><span class="mi">1</span><span class="p">])</span>
        <span class="k">elif</span> <span class="n">permset</span> <span class="o">==</span> <span class="s1">&#39;protect&#39;</span><span class="p">:</span>
            <span class="n">lperms</span> <span class="o">=</span> <span class="nb">list</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
        <span class="k">elif</span> <span class="n">permset</span> <span class="o">==</span> <span class="s1">&#39;default&#39;</span><span class="p">:</span>
            <span class="n">lperms</span> <span class="o">=</span> <span class="nb">list</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">])</span>
        <span class="k">elif</span> <span class="n">permset</span> <span class="o">==</span> <span class="s1">&#39;collaborate&#39;</span><span class="p">:</span>
            <span class="n">lperms</span> <span class="o">=</span> <span class="nb">list</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">])</span>
        <span class="k">elif</span> <span class="n">permset</span> <span class="o">==</span> <span class="s1">&#39;full&#39;</span><span class="p">:</span>
            <span class="n">lperms</span> <span class="o">=</span> <span class="nb">list</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">lperms</span> <span class="o">=</span> <span class="n">permset</span>

        <span class="n">perms</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">pid</span> <span class="ow">in</span> <span class="n">lperms</span><span class="p">:</span>
            <span class="n">perms</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">getObjectRight</span><span class="p">(</span><span class="n">pid</span><span class="p">))</span>

        <span class="k">return</span> <span class="n">perms</span></div>

<div class="viewcode-block" id="VSDConnecter.getObjectGroupRights"><a class="viewcode-back" href="../connect.html#connect.VSDConnecter.getObjectGroupRights">[docs]</a>    <span class="k">def</span> <span class="nf">getObjectGroupRights</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        get the list of attaced group rights of an object</span>

<span class="sd">        :param APIObject obj: the object</span>
<span class="sd">        :return rights: a list of ObjectGroupRights</span>
<span class="sd">        :rtype: list of APIObjectGroupRight</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">rights</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="n">obj</span><span class="o">.</span><span class="n">objectGroupRights</span><span class="p">:</span>
            <span class="n">rights</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
            <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">obj</span><span class="o">.</span><span class="n">objectGroupRights</span><span class="p">:</span>
                <span class="n">res</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getRequest</span><span class="p">(</span><span class="n">item</span><span class="p">[</span><span class="s1">&#39;selfUrl&#39;</span><span class="p">])</span>
                <span class="n">right</span> <span class="o">=</span> <span class="n">vsdModels</span><span class="o">.</span><span class="n">ObjectGroupRight</span><span class="p">()</span>
                <span class="n">right</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">obj</span><span class="o">=</span><span class="n">res</span><span class="p">)</span>
                <span class="n">rights</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">right</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">rights</span></div>

<div class="viewcode-block" id="VSDConnecter.getObjectUserRights"><a class="viewcode-back" href="../connect.html#connect.VSDConnecter.getObjectUserRights">[docs]</a>    <span class="k">def</span> <span class="nf">getObjectUserRights</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        get the list of attaced user rights of an object</span>

<span class="sd">        :param APIObject obj: the object</span>
<span class="sd">        :return: a list of ObjectUserRights</span>
<span class="sd">        :rtype: list APIObjectUserRight</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">rights</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="n">obj</span><span class="o">.</span><span class="n">objectUserRights</span><span class="p">:</span>
            <span class="n">rights</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
            <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">obj</span><span class="o">.</span><span class="n">objectUserRights</span><span class="p">:</span>
                <span class="n">res</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getRequest</span><span class="p">(</span><span class="n">item</span><span class="p">[</span><span class="s1">&#39;selfUrl&#39;</span><span class="p">])</span>
                <span class="n">right</span> <span class="o">=</span> <span class="n">vsdModels</span><span class="o">.</span><span class="n">ObjectUserRight</span><span class="p">()</span>
                <span class="n">right</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">obj</span><span class="o">=</span><span class="n">res</span><span class="p">)</span>
                <span class="n">rights</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">right</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">rights</span></div>

<span class="c1">#################################################</span>
<span class="c1"># api objects handling (MODIFY)</span>
<span class="c1">################################################</span>
<div class="viewcode-block" id="VSDConnecter.postRequest"><a class="viewcode-back" href="../connect.html#connect.VSDConnecter.postRequest">[docs]</a>    <span class="k">def</span> <span class="nf">postRequest</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">resource</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;add data to an object</span>

<span class="sd">        :param str resource: relative path of the resource or selfUrl</span>
<span class="sd">        :param json data: data to be added to the resource</span>
<span class="sd">        :return: the resource object</span>
<span class="sd">        :rtype: json</span>
<span class="sd">        :raises: RequestException</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_post</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fullUrl</span><span class="p">(</span><span class="n">resource</span><span class="p">),</span> <span class="n">json</span><span class="o">=</span><span class="n">data</span><span class="p">)</span></div>

<div class="viewcode-block" id="VSDConnecter.removeLinks"><a class="viewcode-back" href="../connect.html#connect.VSDConnecter.removeLinks">[docs]</a>    <span class="k">def</span> <span class="nf">removeLinks</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">resource</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        removes all related item from an object</span>

<span class="sd">        :param str resource: resouce path url</span>
<span class="sd">        :return: True if successful or False if failed</span>
<span class="sd">        :rtype: bool</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">obj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getObject</span><span class="p">(</span><span class="n">resource</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">obj</span><span class="o">.</span><span class="n">linkedObjectRelations</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">link</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">iteratePageItems</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">linkedObjectRelations</span><span class="p">,</span> <span class="n">vsdModels</span><span class="o">.</span><span class="n">ObjectLink</span><span class="p">):</span>
                <span class="nb">print</span><span class="p">(</span><span class="n">link</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">delRequest</span><span class="p">(</span><span class="n">link</span><span class="o">.</span><span class="n">selfUrl</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;nothing to delete, no links available&#39;</span><span class="p">)</span></div>



<div class="viewcode-block" id="VSDConnecter.delRequest"><a class="viewcode-back" href="../connect.html#connect.VSDConnecter.delRequest">[docs]</a>    <span class="k">def</span> <span class="nf">delRequest</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">resource</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        generic delete request</span>

<span class="sd">        :param str resource: resource path</span>
<span class="sd">        :return: status_code</span>
<span class="sd">        :rtype: int</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">req</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">s</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fullUrl</span><span class="p">(</span><span class="n">resource</span><span class="p">))</span>
            <span class="k">if</span> <span class="n">req</span><span class="o">.</span><span class="n">status_code</span> <span class="o">==</span> <span class="n">requests</span><span class="o">.</span><span class="n">codes</span><span class="o">.</span><span class="n">ok</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;resource </span><span class="si">{0}</span><span class="s1"> deleted, 200&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fullUrl</span><span class="p">(</span><span class="n">resource</span><span class="p">)))</span>
                <span class="k">return</span> <span class="n">req</span><span class="o">.</span><span class="n">status_code</span>
            <span class="k">elif</span> <span class="n">req</span><span class="o">.</span><span class="n">status_code</span> <span class="o">==</span> <span class="n">requests</span><span class="o">.</span><span class="n">codes</span><span class="o">.</span><span class="n">no_content</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;resource </span><span class="si">{0}</span><span class="s1"> deleted, 204&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fullUrl</span><span class="p">(</span><span class="n">resource</span><span class="p">)))</span>
                <span class="k">return</span> <span class="n">req</span><span class="o">.</span><span class="n">status_code</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;resource </span><span class="si">{0}</span><span class="s1"> NOT (not existing or other problem) deleted&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fullUrl</span><span class="p">(</span><span class="n">resource</span><span class="p">)))</span>
                <span class="k">return</span> <span class="n">req</span><span class="o">.</span><span class="n">status_code</span>

        <span class="k">except</span> <span class="n">requests</span><span class="o">.</span><span class="n">exceptions</span><span class="o">.</span><span class="n">RequestException</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;del request failed:&#39;</span><span class="p">,</span> <span class="n">err</span><span class="p">)</span>
            <span class="k">return</span></div>



<div class="viewcode-block" id="VSDConnecter.delObject"><a class="viewcode-back" href="../connect.html#connect.VSDConnecter.delObject">[docs]</a>    <span class="k">def</span> <span class="nf">delObject</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        delete an unvalidated object</span>

<span class="sd">        :param APIObject obj: the object to delete</span>
<span class="sd">        :return: status_code</span>
<span class="sd">        :rtype: int</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">req</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">s</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">selfUrl</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">req</span><span class="o">.</span><span class="n">status_code</span> <span class="o">==</span> <span class="n">requests</span><span class="o">.</span><span class="n">codes</span><span class="o">.</span><span class="n">ok</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;object </span><span class="si">{0}</span><span class="s1"> deleted&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">id</span><span class="p">))</span>
                <span class="k">return</span> <span class="n">req</span><span class="o">.</span><span class="n">status_code</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">req</span><span class="o">.</span><span class="n">status_code</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;not deleted&#39;</span><span class="p">,</span> <span class="n">req</span><span class="o">.</span><span class="n">status_code</span><span class="p">)</span>

        <span class="k">except</span> <span class="n">requests</span><span class="o">.</span><span class="n">exceptions</span><span class="o">.</span><span class="n">RequestException</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;del request failed:&#39;</span><span class="p">,</span> <span class="n">err</span><span class="p">)</span></div>

<div class="viewcode-block" id="VSDConnecter.chunkedread"><a class="viewcode-back" href="../connect.html#connect.VSDConnecter.chunkedread">[docs]</a>    <span class="k">def</span> <span class="nf">chunkedread</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fp</span><span class="p">,</span> <span class="n">chunksize</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        breaks the file into chunks of chunksize</span>

<span class="sd">        :param Path fp: the file to chunk</span>
<span class="sd">        :param int chunksize: size in bytes of the chunk parts</span>
<span class="sd">        :yields: chunk</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">with</span> <span class="n">fp</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s1">&#39;rb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
                <span class="n">chunk</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">chunksize</span><span class="p">)</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">chunk</span><span class="p">:</span>
                    <span class="k">break</span>
                <span class="k">yield</span> <span class="p">(</span><span class="n">chunk</span><span class="p">)</span></div>

<div class="viewcode-block" id="VSDConnecter.chunkFileUpload"><a class="viewcode-back" href="../connect.html#connect.VSDConnecter.chunkFileUpload">[docs]</a>    <span class="k">def</span> <span class="nf">chunkFileUpload</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fp</span><span class="p">,</span> <span class="n">chunksize</span><span class="o">=</span><span class="mi">1024</span> <span class="o">*</span> <span class="mi">4096</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        upload large files in chunks of max 100 MB size</span>

<span class="sd">        :param Path fp: the file to upload</span>
<span class="sd">        :param int chunksize: size in bytes of the chunk parts, default is 4MB</span>
<span class="sd">        :return: the generated object</span>
<span class="sd">        :rtype: APIObject</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">parts</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="n">fp</span><span class="o">.</span><span class="n">stat</span><span class="p">()</span><span class="o">.</span><span class="n">st_size</span> <span class="o">/</span> <span class="nb">float</span><span class="p">(</span><span class="n">chunksize</span><span class="p">)))</span>
        <span class="n">err</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="n">maxchunksize</span> <span class="o">=</span> <span class="mi">1024</span> <span class="o">*</span> <span class="mi">1024</span> <span class="o">*</span> <span class="mi">100</span>
        <span class="k">if</span> <span class="n">chunksize</span> <span class="o">&gt;=</span> <span class="n">maxchunksize</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span>
                <span class="s1">&#39;not uploaded: defined chunksize </span><span class="si">{0}</span><span class="s1"> is bigger than the allowed maximum </span><span class="si">{1}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">chunksize</span><span class="p">,</span> <span class="n">maxchunksize</span><span class="p">))</span>
            <span class="k">return</span> <span class="kc">None</span>

        <span class="n">part</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">part</span><span class="p">,</span> <span class="n">chunk</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">chunkedread</span><span class="p">(</span><span class="n">fp</span><span class="p">,</span> <span class="n">chunksize</span><span class="p">),</span><span class="mi">1</span><span class="p">):</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;(</span><span class="si">{2}</span><span class="s1">)uploading part </span><span class="si">{0}</span><span class="s1"> of </span><span class="si">{1}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">part</span><span class="p">,</span> <span class="n">parts</span><span class="p">,</span> <span class="n">fp</span><span class="o">.</span><span class="n">name</span><span class="p">))</span>
            <span class="n">files</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;file&#39;</span><span class="p">:</span> <span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">fp</span><span class="o">.</span><span class="n">name</span><span class="p">),</span> <span class="n">chunk</span><span class="p">)}</span>
            <span class="n">res</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_post</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fullUrl</span><span class="p">(</span><span class="s1">&#39;/chunked_upload?chunk=</span><span class="si">{0}</span><span class="s1">&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">part</span><span class="p">),</span> <span class="n">files</span><span class="o">=</span><span class="n">files</span><span class="p">)</span>

        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;finish, uploaded part </span><span class="si">{0}</span><span class="s1"> of </span><span class="si">{1}</span><span class="s1"> &#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">part</span><span class="p">,</span> <span class="n">parts</span><span class="p">))</span>
        <span class="n">res</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_post</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fullUrl</span><span class="p">(</span><span class="s1">&#39;chunked_upload/commit?filename=</span><span class="si">{0}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">fp</span><span class="o">.</span><span class="n">name</span><span class="p">)))</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">getFile</span><span class="p">(</span><span class="n">res</span><span class="p">[</span><span class="s1">&#39;file&#39;</span><span class="p">][</span><span class="s1">&#39;selfUrl&#39;</span><span class="p">]),</span> <span class="bp">self</span><span class="o">.</span><span class="n">getObject</span><span class="p">(</span><span class="n">res</span><span class="p">[</span><span class="s1">&#39;relatedObject&#39;</span><span class="p">][</span><span class="s1">&#39;selfUrl&#39;</span><span class="p">])</span></div>

        <span class="c1"># relObj = res[&#39;relatedObject&#39;]</span>
        <span class="c1"># obj = self.getObject(relObj[&#39;selfUrl&#39;])</span>
        <span class="c1"># return obj</span>



<div class="viewcode-block" id="VSDConnecter.postFolder"><a class="viewcode-back" href="../connect.html#connect.VSDConnecter.postFolder">[docs]</a>    <span class="k">def</span> <span class="nf">postFolder</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">check</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        creates the folder with a given name (name) inside a folder (parent) if not already exists</span>

<span class="sd">        :param Folder parent: the root folder</span>
<span class="sd">        :param str name: name of the folder which should be created</span>
<span class="sd">        :param bool check: it we should check if already exist, default = True</span>
<span class="sd">        :return: the folder object of the generated folder or the existing folder</span>
<span class="sd">        :rtype: Folder</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">folder</span> <span class="o">=</span> <span class="n">vsdModels</span><span class="o">.</span><span class="n">Folder</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">parent</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">parent</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getFolderByName</span><span class="p">(</span><span class="s1">&#39;MyProjects&#39;</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;exact&#39;</span><span class="p">)</span>
        <span class="n">folder</span><span class="o">.</span><span class="n">parentFolder</span> <span class="o">=</span> <span class="n">vsdModels</span><span class="o">.</span><span class="n">APIBase</span><span class="p">(</span><span class="n">selfUrl</span><span class="o">=</span><span class="n">parent</span><span class="o">.</span><span class="n">selfUrl</span><span class="p">)</span>
        <span class="n">folder</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>

        <span class="n">exists</span> <span class="o">=</span> <span class="kc">False</span>

        <span class="k">if</span> <span class="n">check</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">parent</span><span class="o">.</span><span class="n">childFolders</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">child</span> <span class="ow">in</span> <span class="n">parent</span><span class="o">.</span><span class="n">childFolders</span><span class="p">:</span>
                    <span class="n">fold</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getFolder</span><span class="p">(</span><span class="n">child</span><span class="o">.</span><span class="n">selfUrl</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">fold</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                        <span class="k">if</span> <span class="n">fold</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="n">name</span><span class="p">:</span>
                            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;folder </span><span class="si">{0}</span><span class="s1"> already exists, id: </span><span class="si">{1}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">fold</span><span class="o">.</span><span class="n">id</span><span class="p">))</span>
                            <span class="n">exists</span> <span class="o">=</span> <span class="kc">True</span>
                            <span class="k">return</span> <span class="n">fold</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;unexpected error, folder exists but cannot be retrieved&#39;</span><span class="p">)</span>
                        <span class="n">exists</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="c1"># print(self.postRequest(&#39;folders&#39;, data = data))</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">exists</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">folder</span><span class="o">.</span><span class="n">to_struct</span><span class="p">()</span>
            <span class="c1"># for name, field in folder:</span>
            <span class="c1">#     if name not in data:</span>
            <span class="c1">#         data[name] = None</span>
            <span class="c1"># print(data)</span>
            <span class="n">res</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">postRequest</span><span class="p">(</span><span class="s1">&#39;folders&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">)</span>
            <span class="n">folder</span><span class="o">.</span><span class="n">populate</span><span class="p">(</span><span class="o">**</span><span class="n">res</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;folder </span><span class="si">{0}</span><span class="s1"> created, has id </span><span class="si">{1}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">folder</span><span class="o">.</span><span class="n">id</span><span class="p">))</span>
            <span class="k">assert</span> <span class="n">folder</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="n">name</span>
            <span class="k">return</span> <span class="n">folder</span></div>

<div class="viewcode-block" id="VSDConnecter.uploadFile"><a class="viewcode-back" href="../connect.html#connect.VSDConnecter.uploadFile">[docs]</a>    <span class="k">def</span> <span class="nf">uploadFile</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        push (post) a file to the server</span>

<span class="sd">        :param Path filename: the file to be uploaded</span>
<span class="sd">        :return: the file object containing the related object selfUrl</span>
<span class="sd">        :rtype: APIObject</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">filename</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">mode</span><span class="o">=</span><span class="s1">&#39;rb&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
            <span class="c1">##workaround for file without file extensions</span>
            <span class="k">if</span> <span class="n">filename</span><span class="o">.</span><span class="n">suffix</span> <span class="o">==</span> <span class="s1">&#39;&#39;</span><span class="p">:</span>
                <span class="n">filename</span> <span class="o">=</span> <span class="n">filename</span><span class="o">.</span><span class="n">with_suffix</span><span class="p">(</span><span class="s1">&#39;.dcm&#39;</span><span class="p">)</span>
            <span class="n">files</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;file&#39;</span><span class="p">:</span> <span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">filename</span><span class="o">.</span><span class="n">name</span><span class="p">),</span> <span class="n">data</span><span class="p">)}</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;opening file&quot;</span><span class="p">,</span> <span class="n">filename</span><span class="p">,</span> <span class="s2">&quot;failed, aborting&quot;</span><span class="p">)</span>
            <span class="k">return</span>

        <span class="n">res</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_post</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">url</span> <span class="o">+</span> <span class="s1">&#39;upload&#39;</span><span class="p">,</span> <span class="n">files</span><span class="o">=</span><span class="n">files</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">getFile</span><span class="p">(</span><span class="n">res</span><span class="p">[</span><span class="s1">&#39;file&#39;</span><span class="p">][</span><span class="s1">&#39;selfUrl&#39;</span><span class="p">]),</span> <span class="bp">self</span><span class="o">.</span><span class="n">getObject</span><span class="p">(</span><span class="n">res</span><span class="p">[</span><span class="s1">&#39;relatedObject&#39;</span><span class="p">][</span><span class="s1">&#39;selfUrl&#39;</span><span class="p">])</span></div>


    <span class="c1">#################################################</span>
    <span class="c1"># api objects handling (UPDATE)</span>
    <span class="c1">################################################</span>
<div class="viewcode-block" id="VSDConnecter.putObject"><a class="viewcode-back" href="../connect.html#connect.VSDConnecter.putObject">[docs]</a>    <span class="k">def</span> <span class="nf">putObject</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;update an objects information</span>

<span class="sd">        :param APIObject obj: an APIObject</span>
<span class="sd">        :return: the updated object</span>
<span class="sd">        :rtype: APIObject</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">res</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">putRequest</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">selfUrl</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">obj</span><span class="o">.</span><span class="n">to_struct</span><span class="p">())</span>

        <span class="k">if</span> <span class="n">res</span><span class="p">:</span>
            <span class="n">obj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">createObject</span><span class="p">(</span><span class="n">res</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">obj</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">res</span></div>

<div class="viewcode-block" id="VSDConnecter.putRequest"><a class="viewcode-back" href="../connect.html#connect.VSDConnecter.putRequest">[docs]</a>    <span class="k">def</span> <span class="nf">putRequest</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">resource</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; update data of an object</span>

<span class="sd">        :param str resource: defines the relative path to the api resource</span>
<span class="sd">        :param json data: data to be added to the object</span>
<span class="sd">        :return: the updated object</span>
<span class="sd">        :rtype: json</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">req</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_put</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fullUrl</span><span class="p">(</span><span class="n">resource</span><span class="p">),</span> <span class="n">json</span><span class="o">=</span><span class="n">data</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">req</span>
        <span class="k">except</span> <span class="n">requests</span><span class="o">.</span><span class="n">exceptions</span><span class="o">.</span><span class="n">RequestException</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;request failed:&#39;</span><span class="p">,</span> <span class="n">err</span><span class="p">)</span>
            <span class="k">return</span> <span class="kc">None</span></div>

<div class="viewcode-block" id="VSDConnecter.postRequestSimple"><a class="viewcode-back" href="../connect.html#connect.VSDConnecter.postRequestSimple">[docs]</a>    <span class="k">def</span> <span class="nf">postRequestSimple</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">resource</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        post (create) a resource</span>

<span class="sd">        :param str resource: resource path</span>
<span class="sd">        :return: the resource object</span>
<span class="sd">        :rtype: json</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">req</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">s</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fullUrl</span><span class="p">(</span><span class="n">resource</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">req</span><span class="o">.</span><span class="n">json</span><span class="p">()</span></div>

<div class="viewcode-block" id="VSDConnecter.putRequestSimple"><a class="viewcode-back" href="../connect.html#connect.VSDConnecter.putRequestSimple">[docs]</a>    <span class="k">def</span> <span class="nf">putRequestSimple</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">resource</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        put (update) a resource</span>

<span class="sd">        :param str resource: resource path</span>
<span class="sd">        :return: the resource object</span>
<span class="sd">        :rtype: json</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">req</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">s</span><span class="o">.</span><span class="n">put</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fullUrl</span><span class="p">(</span><span class="n">resource</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">req</span><span class="o">.</span><span class="n">json</span><span class="p">()</span></div>

<div class="viewcode-block" id="VSDConnecter.publishObject"><a class="viewcode-back" href="../connect.html#connect.VSDConnecter.publishObject">[docs]</a>    <span class="k">def</span> <span class="nf">publishObject</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        publisch an unvalidated object</span>

<span class="sd">        :param APIObject obj: the object to publish</span>
<span class="sd">        :return: returns the object</span>
<span class="sd">        :rtype: APIObject</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">req</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">s</span><span class="o">.</span><span class="n">put</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">selfUrl</span> <span class="o">+</span> <span class="s1">&#39;/publish&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">req</span><span class="o">.</span><span class="n">status_code</span> <span class="o">==</span> <span class="n">requests</span><span class="o">.</span><span class="n">codes</span><span class="o">.</span><span class="n">ok</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;object </span><span class="si">{0}</span><span class="s1"> published&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">id</span><span class="p">))</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">getObject</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">selfUrl</span><span class="p">)</span>


        <span class="k">except</span> <span class="n">requests</span><span class="o">.</span><span class="n">exceptions</span><span class="o">.</span><span class="n">RequestException</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;publish request failed:&#39;</span><span class="p">,</span> <span class="n">err</span><span class="p">)</span></div>

<div class="viewcode-block" id="VSDConnecter.deleteFolderContent"><a class="viewcode-back" href="../connect.html#connect.VSDConnecter.deleteFolderContent">[docs]</a>    <span class="k">def</span> <span class="nf">deleteFolderContent</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">folder</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; delete all content from a folder (Folder)</span>

<span class="sd">        :param Folder folder: a folder object</span>
<span class="sd">        :return state: returns true if successful, else False</span>
<span class="sd">        :rtype: bool</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">state</span> <span class="o">=</span> <span class="kc">False</span>

        <span class="n">folder</span><span class="o">.</span><span class="n">containedObjects</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="n">res</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">putRequest</span><span class="p">(</span><span class="s1">&#39;folders&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">folder</span><span class="o">.</span><span class="n">to_struct</span><span class="p">())</span></div>

<div class="viewcode-block" id="VSDConnecter.postObjectRights"><a class="viewcode-back" href="../connect.html#connect.VSDConnecter.postObjectRights">[docs]</a>    <span class="k">def</span> <span class="nf">postObjectRights</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="p">,</span> <span class="n">group</span><span class="p">,</span> <span class="n">perms</span><span class="p">,</span> <span class="n">isuser</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        translate a set of permissions and a group into the appropriate format and add it to the object</span>


<span class="sd">        .. warning:: DEPRECATED: use postObjectGroupRights or postObjectUserRights!</span>


<span class="sd">        :param APIObject obj: () the object you want to add the permissions to</span>
<span class="sd">        :param APIGroup/APIUser group: group object or user object</span>
<span class="sd">        :param list perms: list of Object Rights (APIObjectRight), use getPermissionSet to retrive the ObjectRights based on the permission sets</span>
<span class="sd">        :param bool isuser: set True if the groups variable is a user. Default is False</span>
<span class="sd">        :return: a group or user rights object</span>
<span class="sd">        :rtype: APIObjectGroupRight,APIObjectUserRight</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># creat the dict of rights</span>
        <span class="n">rights</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">perm</span> <span class="ow">in</span> <span class="n">perms</span><span class="p">:</span>
            <span class="n">rights</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">dict</span><span class="p">([(</span><span class="s1">&#39;selfUrl&#39;</span><span class="p">,</span> <span class="n">perm</span><span class="o">.</span><span class="n">selfUrl</span><span class="p">)]))</span>

        <span class="k">if</span> <span class="n">isuser</span><span class="p">:</span>
            <span class="n">objRight</span> <span class="o">=</span> <span class="n">vsdModels</span><span class="o">.</span><span class="n">ObjectUserRight</span><span class="p">()</span>
            <span class="n">objRight</span><span class="o">.</span><span class="n">relatedObject</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">([(</span><span class="s1">&#39;selfUrl&#39;</span><span class="p">,</span> <span class="n">obj</span><span class="o">.</span><span class="n">selfUrl</span><span class="p">)])</span>
            <span class="n">objRight</span><span class="o">.</span><span class="n">relatedRights</span> <span class="o">=</span> <span class="n">rights</span>
            <span class="n">objRight</span><span class="o">.</span><span class="n">relatedUser</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">([(</span><span class="s1">&#39;selfUrl&#39;</span><span class="p">,</span> <span class="n">group</span><span class="o">.</span><span class="n">selfUrl</span><span class="p">)])</span>
            <span class="n">res</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">postRequest</span><span class="p">(</span><span class="s1">&#39;object-user-rights&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">objRight</span><span class="o">.</span><span class="n">to_struct</span><span class="p">())</span>
            <span class="n">objRight</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">res</span><span class="p">)</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="n">objRight</span> <span class="o">=</span> <span class="n">vsdModels</span><span class="o">.</span><span class="n">ObjectGroupRight</span><span class="p">()</span>
            <span class="n">objRight</span><span class="o">.</span><span class="n">relatedObject</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">([(</span><span class="s1">&#39;selfUrl&#39;</span><span class="p">,</span> <span class="n">obj</span><span class="o">.</span><span class="n">selfUrl</span><span class="p">)])</span>
            <span class="n">objRight</span><span class="o">.</span><span class="n">relatedRights</span> <span class="o">=</span> <span class="n">rights</span>
            <span class="n">objRight</span><span class="o">.</span><span class="n">relatedGroup</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">([(</span><span class="s1">&#39;selfUrl&#39;</span><span class="p">,</span> <span class="n">group</span><span class="o">.</span><span class="n">selfUrl</span><span class="p">)])</span>
            <span class="n">res</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">postRequest</span><span class="p">(</span><span class="s1">&#39;object-group-rights&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">objRight</span><span class="o">.</span><span class="n">to_struct</span><span class="p">())</span>
            <span class="n">objRight</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">res</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">objRight</span></div>

<div class="viewcode-block" id="VSDConnecter.postObjectUserRights"><a class="viewcode-back" href="../connect.html#connect.VSDConnecter.postObjectUserRights">[docs]</a>    <span class="k">def</span> <span class="nf">postObjectUserRights</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="p">,</span> <span class="n">user</span><span class="p">,</span> <span class="n">perms</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; translate a set of permissions and a user into the appropriate format and add it to the object</span>

<span class="sd">        :param Object obj: the object you want to add the permissions to</span>
<span class="sd">        :param User user: user object</span>
<span class="sd">        :param list perms: list of Object Rights (APIObjectRight), use getPermissionSet to retrive the ObjectRights based on the permission sets</span>
<span class="sd">        :return: user rights object</span>
<span class="sd">        :rtype: ObjectUserRight</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># creat the dict of rights</span>
        <span class="n">rights</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">perm</span> <span class="ow">in</span> <span class="n">perms</span><span class="p">:</span>
            <span class="n">rights</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">dict</span><span class="p">([(</span><span class="s1">&#39;selfUrl&#39;</span><span class="p">,</span> <span class="n">perm</span><span class="o">.</span><span class="n">selfUrl</span><span class="p">)]))</span>

        <span class="n">objRight</span> <span class="o">=</span> <span class="n">vsdModels</span><span class="o">.</span><span class="n">ObjectUserRight</span><span class="p">()</span>
        <span class="n">objRight</span><span class="o">.</span><span class="n">relatedObject</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">([(</span><span class="s1">&#39;selfUrl&#39;</span><span class="p">,</span> <span class="n">obj</span><span class="o">.</span><span class="n">selfUrl</span><span class="p">)])</span>
        <span class="n">objRight</span><span class="o">.</span><span class="n">relatedRights</span> <span class="o">=</span> <span class="n">rights</span>
        <span class="n">objRight</span><span class="o">.</span><span class="n">relatedUser</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">([(</span><span class="s1">&#39;selfUrl&#39;</span><span class="p">,</span> <span class="n">user</span><span class="o">.</span><span class="n">selfUrl</span><span class="p">)])</span>

        <span class="n">res</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">postRequest</span><span class="p">(</span><span class="s1">&#39;object-user-rights&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">objRight</span><span class="o">.</span><span class="n">to_struct</span><span class="p">())</span>
        <span class="n">objRight</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">res</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">objRight</span></div>

<div class="viewcode-block" id="VSDConnecter.postObjectGroupRights"><a class="viewcode-back" href="../connect.html#connect.VSDConnecter.postObjectGroupRights">[docs]</a>    <span class="k">def</span> <span class="nf">postObjectGroupRights</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="p">,</span> <span class="n">group</span><span class="p">,</span> <span class="n">perms</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; translate a set of permissions and a group into the appropriate format and add it to the object</span>

<span class="sd">        :param Object obj: the object you want to add the permissions to</span>
<span class="sd">        :param Group group: group object</span>
<span class="sd">        :param list perms: list of Object Rights (APIObjectRight), use getPermissionSet to retrive the ObjectRights based on the permission sets</span>
<span class="sd">        :return: group rights object</span>
<span class="sd">        :rtype: ObjectGroupRight</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># creat the dict of rights</span>
        <span class="n">rights</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>

        <span class="k">for</span> <span class="n">perm</span> <span class="ow">in</span> <span class="n">perms</span><span class="p">:</span>
            <span class="n">rights</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">dict</span><span class="p">([(</span><span class="s1">&#39;selfUrl&#39;</span><span class="p">,</span> <span class="n">perm</span><span class="o">.</span><span class="n">selfUrl</span><span class="p">)]))</span>

        <span class="n">objRight</span> <span class="o">=</span> <span class="n">vsdModels</span><span class="o">.</span><span class="n">ObjectGroupRight</span><span class="p">()</span>
        <span class="n">objRight</span><span class="o">.</span><span class="n">relatedObject</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">([(</span><span class="s1">&#39;selfUrl&#39;</span><span class="p">,</span> <span class="n">obj</span><span class="o">.</span><span class="n">selfUrl</span><span class="p">)])</span>
        <span class="n">objRight</span><span class="o">.</span><span class="n">relatedRights</span> <span class="o">=</span> <span class="n">rights</span>
        <span class="n">objRight</span><span class="o">.</span><span class="n">relatedGroup</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">([(</span><span class="s1">&#39;selfUrl&#39;</span><span class="p">,</span> <span class="n">group</span><span class="o">.</span><span class="n">selfUrl</span><span class="p">)])</span>

        <span class="n">res</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">postRequest</span><span class="p">(</span><span class="s1">&#39;object-group-rights&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">objRight</span><span class="o">.</span><span class="n">to_struct</span><span class="p">())</span>
        <span class="n">objRight</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">res</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">objRight</span></div>

<div class="viewcode-block" id="VSDConnecter.addLink"><a class="viewcode-back" href="../connect.html#connect.VSDConnecter.addLink">[docs]</a>    <span class="k">def</span> <span class="nf">addLink</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj1</span><span class="p">,</span> <span class="n">obj2</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; add an object link</span>

<span class="sd">        :param APIBase obj1: a linked object with selfUrl</span>
<span class="sd">        :param APIBase obj2: a linked object with selfUrl</span>
<span class="sd">        :return: the created object-link</span>
<span class="sd">        :rtype: json</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">link</span> <span class="o">=</span> <span class="n">vsdModels</span><span class="o">.</span><span class="n">ObjectLink</span><span class="p">(</span><span class="n">object1</span><span class="o">=</span><span class="n">obj1</span><span class="p">,</span> <span class="n">object2</span><span class="o">=</span><span class="n">obj2</span><span class="p">)</span>
        <span class="n">link</span><span class="o">.</span><span class="n">validate</span><span class="p">()</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">postRequest</span><span class="p">(</span><span class="s1">&#39;object-links&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">link</span><span class="o">.</span><span class="n">to_struct</span><span class="p">())</span></div>

<div class="viewcode-block" id="VSDConnecter.addOntologyToObject"><a class="viewcode-back" href="../connect.html#connect.VSDConnecter.addOntologyToObject">[docs]</a>    <span class="k">def</span> <span class="nf">addOntologyToObject</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="p">,</span> <span class="n">ontology</span><span class="p">,</span> <span class="n">pos</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; add an ontoly term to an object</span>

<span class="sd">        :param APIBase obj: basic object</span>
<span class="sd">        :param Ontology ontology: ontology object</span>
<span class="sd">        :param int pos: position of the ontology term, default = 1</span>
<span class="sd">        :return: returns true if successfully added</span>
<span class="sd">        :rtype: bool</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">isset</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">pos</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
            <span class="n">onto</span> <span class="o">=</span> <span class="n">vsdModels</span><span class="o">.</span><span class="n">ObjectOntology</span><span class="p">()</span>
            <span class="n">onto</span><span class="o">.</span><span class="n">position</span> <span class="o">=</span> <span class="n">pos</span>
            <span class="n">onto</span><span class="o">.</span><span class="n">object</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">([(</span><span class="s1">&#39;selfUrl&#39;</span><span class="p">,</span> <span class="n">obj</span><span class="o">.</span><span class="n">selfUrl</span><span class="p">)])</span>
            <span class="n">onto</span><span class="o">.</span><span class="n">ontologyItem</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">([(</span><span class="s1">&#39;selfUrl&#39;</span><span class="p">,</span> <span class="n">ontology</span><span class="o">.</span><span class="n">selfUrl</span><span class="p">)])</span>
            <span class="n">onto</span><span class="o">.</span><span class="n">type</span> <span class="o">=</span> <span class="n">ontology</span><span class="o">.</span><span class="n">type</span>

            <span class="n">res</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">postRequest</span><span class="p">(</span><span class="s1">&#39;object-ontologies/</span><span class="si">{0}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">ontology</span><span class="o">.</span><span class="n">type</span><span class="p">),</span> <span class="n">data</span><span class="o">=</span><span class="n">onto</span><span class="o">.</span><span class="n">to_struct</span><span class="p">())</span>
            <span class="k">if</span> <span class="n">res</span><span class="p">:</span>
                <span class="n">isset</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;position needs to be a number (int)&#39;</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">isset</span></div>

<div class="viewcode-block" id="VSDConnecter.deleteFolder"><a class="viewcode-back" href="../connect.html#connect.VSDConnecter.deleteFolder">[docs]</a>    <span class="k">def</span> <span class="nf">deleteFolder</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">folder</span><span class="p">,</span> <span class="n">recursive</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;remove a folder (Folder)</span>

<span class="sd">        :param Folder folder: the folder object</span>
<span class="sd">        :return: True if deleted, False if not</span>
<span class="sd">        :rtype: bool</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">state</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">deleteFolderContent</span><span class="p">(</span><span class="n">folder</span><span class="p">)</span>
        <span class="n">res</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">delRequest</span><span class="p">(</span><span class="n">folder</span><span class="o">.</span><span class="n">selfUrl</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">res</span> <span class="o">==</span> <span class="mi">200</span> <span class="ow">or</span> <span class="n">res</span> <span class="o">==</span> <span class="mi">204</span><span class="p">:</span>
            <span class="n">state</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">if</span> <span class="n">recursive</span><span class="p">:</span>
            <span class="n">folders</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getContainedFolders</span><span class="p">(</span><span class="n">folder</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">folders</span><span class="p">:</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">deleteFolder</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">recursive</span><span class="o">=</span><span class="n">recursive</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">state</span></div>

<div class="viewcode-block" id="VSDConnecter.createFolderStructure"><a class="viewcode-back" href="../connect.html#connect.VSDConnecter.createFolderStructure">[docs]</a>    <span class="k">def</span> <span class="nf">createFolderStructure</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">rootfolder</span><span class="p">,</span> <span class="n">filepath</span><span class="p">,</span> <span class="n">parents</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        creates the folders based on the filepath if not already existing,</span>
<span class="sd">        starting from the rootfolder</span>

<span class="sd">        :param Folder rootfolder: the root folder object</span>
<span class="sd">        :param Path filepath: filepath of the file</span>
<span class="sd">        :param int parents: number of partent levels to create from file folder</span>
<span class="sd">        :return: the last folder in the tree</span>
<span class="sd">        :rtype: Folder</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">fp</span> <span class="o">=</span> <span class="n">filepath</span><span class="o">.</span><span class="n">resolve</span><span class="p">()</span>
        <span class="n">folders</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">fp</span><span class="o">.</span><span class="n">parts</span><span class="p">)</span>
        <span class="n">folders</span><span class="o">.</span><span class="n">reverse</span><span class="p">()</span>

        <span class="c1">##remove file from list</span>
        <span class="k">if</span> <span class="n">fp</span><span class="o">.</span><span class="n">is_file</span><span class="p">():</span>
            <span class="n">folders</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">folders</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">parents</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">folders</span><span class="p">)):</span>
            <span class="n">folders</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">folders</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>

        <span class="n">folders</span><span class="o">.</span><span class="n">reverse</span><span class="p">()</span>
        <span class="n">fparent</span> <span class="o">=</span> <span class="n">rootfolder</span>

        <span class="k">if</span> <span class="n">fparent</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">fname</span> <span class="ow">in</span> <span class="n">folders</span><span class="p">:</span>
                <span class="n">fchild</span> <span class="o">=</span> <span class="kc">None</span>
                <span class="k">if</span> <span class="n">fparent</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">fparent</span><span class="o">.</span><span class="n">childFolders</span><span class="p">:</span>
                        <span class="k">for</span> <span class="n">child</span> <span class="ow">in</span> <span class="n">fparent</span><span class="o">.</span><span class="n">childFolders</span><span class="p">:</span>
                            <span class="n">fold</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getFolder</span><span class="p">(</span><span class="n">child</span><span class="o">.</span><span class="n">selfUrl</span><span class="p">)</span>
                            <span class="k">if</span> <span class="n">fold</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="n">fname</span><span class="p">:</span>
                                <span class="n">fchild</span> <span class="o">=</span> <span class="n">fold</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">fchild</span><span class="p">:</span>
                    <span class="n">f</span> <span class="o">=</span> <span class="n">vsdModels</span><span class="o">.</span><span class="n">Folder</span><span class="p">()</span>
                    <span class="n">f</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">fname</span>
                    <span class="n">f</span><span class="o">.</span><span class="n">parentFolder</span> <span class="o">=</span> <span class="n">vsdModels</span><span class="o">.</span><span class="n">Folder</span><span class="p">(</span><span class="n">selfUrl</span><span class="o">=</span><span class="n">fparent</span><span class="o">.</span><span class="n">selfUrl</span><span class="p">)</span>
                    <span class="c1"># f.toJson()</span>
                    <span class="n">res</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">postRequest</span><span class="p">(</span><span class="s1">&#39;folders&#39;</span><span class="p">,</span> <span class="n">f</span><span class="o">.</span><span class="n">to_struct</span><span class="p">())</span>
                    <span class="n">fparent</span><span class="o">.</span><span class="n">populate</span><span class="p">(</span><span class="o">**</span><span class="n">res</span><span class="p">)</span>

                <span class="k">else</span><span class="p">:</span>
                    <span class="n">fparent</span> <span class="o">=</span> <span class="n">fchild</span>

            <span class="k">return</span> <span class="n">fparent</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Root folder does not exist&#39;</span><span class="p">,</span> <span class="n">rootfolder</span><span class="p">)</span>
            <span class="c1"># jData = jFolder(folder)</span>
            <span class="k">return</span> <span class="kc">None</span></div>

<div class="viewcode-block" id="VSDConnecter.addObjectToFolder"><a class="viewcode-back" href="../connect.html#connect.VSDConnecter.addObjectToFolder">[docs]</a>    <span class="k">def</span> <span class="nf">addObjectToFolder</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">target</span><span class="p">,</span> <span class="n">obj</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        add an object to the folder</span>

<span class="sd">        :param Folder target: the target folder</span>
<span class="sd">        :param Object obj: the object to copy</span>
<span class="sd">        :return: updated folder</span>
<span class="sd">        :rtype: Folder</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">objSelfUrl</span> <span class="o">=</span> <span class="n">vsdModels</span><span class="o">.</span><span class="n">APIBase</span><span class="p">(</span><span class="o">**</span><span class="n">obj</span><span class="o">.</span><span class="n">to_struct</span><span class="p">())</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">objSelfUrl</span> <span class="ow">in</span> <span class="n">target</span><span class="o">.</span><span class="n">containedObjects</span><span class="p">:</span>
            <span class="n">target</span><span class="o">.</span><span class="n">containedObjects</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">objSelfUrl</span><span class="p">)</span>
            <span class="n">res</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">putRequest</span><span class="p">(</span><span class="s1">&#39;folders&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">target</span><span class="o">.</span><span class="n">to_struct</span><span class="p">())</span>

            <span class="n">target</span> <span class="o">=</span> <span class="n">vsdModels</span><span class="o">.</span><span class="n">Folder</span><span class="p">(</span><span class="o">**</span><span class="n">res</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">target</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">target</span></div>

<div class="viewcode-block" id="VSDConnecter.removeObjectFromFolder"><a class="viewcode-back" href="../connect.html#connect.VSDConnecter.removeObjectFromFolder">[docs]</a>    <span class="k">def</span> <span class="nf">removeObjectFromFolder</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">target</span><span class="p">,</span> <span class="n">obj</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        remove an object from the folder</span>

<span class="sd">        :param APIFolder target: the target folder</span>
<span class="sd">        :param APIObject obj: the object to remove</span>
<span class="sd">        :return: updated folder</span>
<span class="sd">        :rtype: APIFolder</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">objSelfUrl</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">([(</span><span class="s1">&#39;selfUrl&#39;</span><span class="p">,</span> <span class="n">obj</span><span class="o">.</span><span class="n">selfUrl</span><span class="p">)])</span>
        <span class="n">objects</span> <span class="o">=</span> <span class="n">target</span><span class="o">.</span><span class="n">containedObjects</span>

        <span class="n">isset</span> <span class="o">=</span> <span class="kc">False</span>

        <span class="k">if</span> <span class="n">objects</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">objects</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="n">objSelfUrl</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">objects</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">objSelfUrl</span><span class="p">)</span>
                <span class="n">target</span><span class="o">.</span><span class="n">containedObjects</span> <span class="o">=</span> <span class="n">objects</span>
                <span class="n">res</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">putRequest</span><span class="p">(</span><span class="s1">&#39;folders&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">target</span><span class="o">.</span><span class="n">to_struct</span><span class="p">())</span>

                <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">res</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
                    <span class="n">isset</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;object not part of that folder&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;folder containes no objects&#39;</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">isset</span></div></div>
</pre></div>

           </div>
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2016, Michael Kistler.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'0.8.1',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>